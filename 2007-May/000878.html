<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Plearn-commits] r7429 - in	trunk/plearn_learners/online/test/DeepBeliefNet: .	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/Split0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/Split0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/Split0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/Split0
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/plearn-commits/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:plearn-commits%40lists.berlios.de?Subject=Re%3A%20%5BPlearn-commits%5D%20r7429%20-%20in%0A%09trunk/plearn_learners/online/test/DeepBeliefNet%3A%20.%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/Split0%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/Split0%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/Split0%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/Split0&In-Reply-To=%3C200705301559.l4UFxNGL010399%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000877.html">
   <LINK REL="Next"  HREF="000879.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Plearn-commits] r7429 - in	trunk/plearn_learners/online/test/DeepBeliefNet: .	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/Split0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/Split0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/Split0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/Split0</H1>
    <B>lamblin at BerliOS</B> 
    <A HREF="mailto:plearn-commits%40lists.berlios.de?Subject=Re%3A%20%5BPlearn-commits%5D%20r7429%20-%20in%0A%09trunk/plearn_learners/online/test/DeepBeliefNet%3A%20.%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/Split0%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/Split0%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/Split0%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1%0A%09.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/Split0&In-Reply-To=%3C200705301559.l4UFxNGL010399%40sheep.berlios.de%3E"
       TITLE="[Plearn-commits] r7429 - in	trunk/plearn_learners/online/test/DeepBeliefNet: .	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/Split0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/Split0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/Split0	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1	.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/Split0">lamblin at mail.berlios.de
       </A><BR>
    <I>Wed May 30 17:59:23 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000877.html">[Plearn-commits] r7428 - trunk/plearn_learners/online
</A></li>
        <LI>Next message: <A HREF="000879.html">[Plearn-commits] r7430 - trunk/plearn/vmat
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#878">[ date ]</a>
              <a href="thread.html#878">[ thread ]</a>
              <a href="subject.html#878">[ subject ]</a>
              <a href="author.html#878">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: lamblin
Date: 2007-05-30 17:59:19 +0200 (Wed, 30 May 2007)
New Revision: 7429

Modified:
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/Split0/final_learner.psave
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/global_stats.pmat
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/split_stats.pmat
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/Split0/final_learner.psave
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/global_stats.pmat
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/split_stats.pmat
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/Split0/final_learner.psave
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/global_stats.pmat
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/split_stats.pmat
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/Split0/final_learner.psave
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/global_stats.pmat
   trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/split_stats.pmat
   trunk/plearn_learners/online/test/DeepBeliefNet/PL_DBN_Mini-batch.pyplearn
   trunk/plearn_learners/online/test/DeepBeliefNet/pytest.config
Log:
Re-enable test with new results


Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/Split0/final_learner.psave
===================================================================
--- trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/Split0/final_learner.psave	2007-05-30 15:46:36 UTC (rev 7428)
+++ trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/Split0/final_learner.psave	2007-05-30 15:59:19 UTC (rev 7429)
@@ -15,7 +15,7 @@
 ;
 gibbs_ma_increment = 0.100000000000000006 ;
 gibbs_initial_ma_coefficient = 0.100000000000000006 ;
-bias = 2 [ 0.0400000000000000078 0.0500000000000000028 ] ;
+bias = 2 [ 0.52000000000000024 0.450000000000000233 ] ;
 input_size = 2 ;
 output_size = 2 ;
 name = &quot;RBMBinomialLayer&quot; ;
@@ -25,7 +25,7 @@
 seed = 1827 ;
 fixed_seed = 0  )
  )
-*4 -&gt;RBMBinomialLayer(
+*4 -&gt;RBMMultinomialLayer(
 size = 100 ;
 learning_rate = 0.0100000000000000002 ;
 momentum = 0 ;
@@ -33,116 +33,116 @@
 ;
 gibbs_ma_increment = 0.100000000000000006 ;
 gibbs_initial_ma_coefficient = 0.100000000000000006 ;
-bias = 100 [ -1.24732375079708047 -1.30170654312842604 0.00946604253898476397 0.0110884036191258861 0.00756114896978595744 0.00950555096666704305 0.0094252374470802612 0.00853827763365329687 0.0100251783298887665 0.0105975479119003319 0.00848657515255510884 0.0103483061876255729 0.00705141045269494331 0.00766568708153920683 0.00884288336824152858 0.0101530829585554545 0.0105164289944283135 0.00746466529008548655 0.00944727113671240543 0.00712506028002141481 0.0107156972362692834 0.00987950335797318363 0.00857934157420571324 0.0096762863306108747 0.00988600414184835456 0.00735221624563170677 0.00798678447198473453 0.00717299650337764692 0.0101819711191810987 0.0089921470194532175 0.00928881237872644129 0.0114095390758898428 0.00815251326660524148 0.0115066125881001392 0.00751634854024539611 0.00771707448412767109 0.00949253546186637834 0.00913410149119166064 0.0113119935252551686 0.00922936634535142728 0.0107848606536458912 0.00835393018616127636 0.0103490252001777923 0.0092!
 0429120948648358 0.0108015562839066243 0.00728567476130176708 0.00940720108092007491 0.00693892507458858561 0.00901808027168178594 0.00753476934279156789 0.00763732976041083065 0.00696348077044447056 0.00735011463908974774 0.00800870481639424404 0.0101606367296152248 0.00987619150268766698 0.0121838861375261221 0.0081447447255705574 0.0105802021616074257 0.0105043386215351794 0.009435606860498073 0.00837953164800392218 0.00832352233355813063 0.0105250949380440925 0.0112356570736240665 0.00921480922284994598 0.0109293231099877267 0.00891653595118224035 0.00946522222049216155 0.00710522455430230831 0.0110461558805261539 0.00998161359320788068 0.00996490151829580555 0.0100799228197163224 0.00982657979231225422 0.0111316366780105421 0.00840586541445523423 0.00871013659534395322 0.0100481444766601404 0.0103582999930174249 0.0091224979337046104 0.00881645151332525502 0.00953438469392447856 0.0114682201136306686 0.00834846005804397787 0.0120117711605062204 0.00990311220351744979 0!
 .00897412022182444459 0.00954370594871390213 0.010383596279755!
 5938 0.0
0966690421537500129 0.00966558087597682407 0.00772346897635070757 0.00886628342219557448 0.00826184450010826119 0.00962086706085879019 0.00748676143262516115 0.00920506558978155705 0.0096505814630842672 0.0108801782659880761 ] ;
+bias = 100 [ -3.21580575368705368 -3.22364753521804781 0.0657827866426371755 0.0696030904799730954 0.0622029618057324957 0.0657378684765310972 0.0656101265818516827 0.0638544637987858155 0.066834155056612693 0.06851399357392432 0.0638885967214564421 0.0682193222523920367 0.0614189353126122703 0.0625664766511173087 0.0644591111231603703 0.0672080258882709475 0.0681189224163839119 0.0620144498236062935 0.0658168511287077068 0.0614584698111661498 0.0685006396586318317 0.0670479847182284955 0.0641700406260315298 0.0661248069558832696 0.0671701269075536539 0.0619280966934446855 0.0631002357645635142 0.0616579996278061107 0.0672834623592647452 0.0648275672466712555 0.0651764494044027171 0.0700494806732006453 0.0633482123265595304 0.0705131377405389115 0.0622909603789631242 0.0628167867929062956 0.0663347352041287752 0.0649449035714201317 0.0699396681514389273 0.0655818667632351859 0.0685066157524031466 0.0638341419302661112 0.0675948606542311481 0.066125477314180614 0.06856318275!
 81079101 0.0618955421308295811 0.0659183468910491677 0.0612163654801688162 0.0654024349135764044 0.0621983451516724406 0.0622920880548175557 0.061245812941509839 0.0618062259590423102 0.0630664460752235617 0.0669921649854180873 0.0666066772938697232 0.0718850881647959683 0.0635225507551099161 0.0682316342600248621 0.0678732444344292557 0.0660568040568560999 0.0640291125303126818 0.0636386992597940543 0.0679831833666539737 0.0699530259034038676 0.0660419388372846805 0.0688321552553833454 0.0649094861976335091 0.065869184195756797 0.0614068151019241601 0.0690146718658728037 0.0673971388239837654 0.0672023840821927426 0.0671655330874224299 0.0664861857760034314 0.0693207953501458057 0.0637773254435998888 0.0642392433002831748 0.0668207490601321341 0.0679989486904433588 0.0652705848529419042 0.0645560824978384101 0.0664835106333893366 0.0702736876926789017 0.0636389201503628904 0.0714316391373439191 0.0665688382090242059 0.0651440873146577892 0.0660134349623082289 0.06810149087!
 29601215 0.0664832647847770769 0.0662017489390426123 0.0627373!
 53259297
7873 0.064759889243550986 0.0639710264357981478 0.0659921336077071846 0.0622046577630927522 0.0658226101336753244 0.0660693261083197952 0.0686926071107428898 ] ;
 input_size = 100 ;
 output_size = 100 ;
-name = &quot;RBMBinomialLayer&quot; ;
+name = &quot;RBMMultinomialLayer&quot; ;
 estimate_simpler_diag_hessian = 0 ;
 expdir = &quot;&quot; ;
 random_gen = *3   )
 ] ;
 connections = 1 [ *5 -&gt;RBMMatrixConnection(
 weights = 100  2  [ 
--0.562832342092569826 	-0.618899674620955964 	
--0.468003462018240612 	-0.487037321254513711 	
-0.0645136743666302886 	0.0020262034608030991 	
--0.0582384599474075129 	0.000718351839955346698 	
-0.113723536552758533 	0.0812258775156319418 	
-0.0890633589207752707 	-0.0196788783852548631 	
-0.0926061657070645777 	-0.0197662247803191971 	
-0.122225510654690464 	0.0129228487485047051 	
-0.0708247830088878927 	-0.0393932413525457728 	
--0.0461639591846139188 	0.0248346290929143294 	
-0.0883660617115444719 	0.0455069722418455017 	
--0.0624245137550703613 	0.0510887764945418821 	
-0.101717764954632112 	0.12266368839991347 	
-0.0753583504101726365 	0.106943946059698189 	
-0.112450033475078676 	0.000398911926204947485 	
-0.0372215714827674807 	-0.0186795945088453 	
--0.00276325708308123056 	-0.00846677564546837076 	
-0.120671962316003689 	0.0814953446640271501 	
-0.0440521566017473276 	0.0223313103096619212 	
-0.123601276063148857 	0.100208876330588267 	
-0.000869864508440939448 	-0.0248939552990395871 	
--0.0274467201509246035 	0.0542065755699414203 	
-0.0655097558505437355 	0.0575733356892307035 	
-0.0823373701138384734 	-0.0271685714344582045 	
--0.0508702586406924659 	0.0768778490167639911 	
-0.102830314174325296 	0.103999487262033993 	
-0.0752869494577488724 	0.0869981986562127635 	
-0.102278027446321876 	0.115640477294141439 	
-0.0375062299947009695 	-0.0219948544226325586 	
-0.0775589944126928305 	0.0232509828726565164 	
-0.124571276641013057 	-0.0335260701569463568 	
--0.0357825435852594936 	-0.0357641745539031761 	
-0.0809363096695901035 	0.0733207707083408655 	
--0.0653407753866376562 	-0.0215807261343096725 	
-0.0838018625307951209 	0.110207129682034152 	
-0.047065231269973147 	0.128193040203437025 	
--0.0271739723498505559 	0.0791291797234443678 	
-0.110749960292860744 	-0.0128160576729877598 	
--0.0456181822703426235 	-0.0228111480648454275 	
-0.0123048785819409312 	0.0642557761998747978 	
-0.0266801181785437033 	-0.050532276443726383 	
-0.0554196904675251928 	0.0800333007019159715 	
-0.034892993702406748 	-0.0289485340857360621 	
--0.0632203886360312578 	0.126471348692204583 	
-0.0157026379602538332 	-0.0409131708696733945 	
-0.0892679063050306476 	0.119633648805189396 	
-0.010983092859141369 	0.0533407020677062541 	
-0.111922563739754413 	0.121356083918362043 	
--0.0103662405371254245 	0.0932836306590351105 	
-0.107712097080637934 	0.0887381251251743441 	
-0.123696128864903707 	0.0687815367839996195 	
-0.115807440032832276 	0.116678132772891546 	
-0.125624185785144837 	0.0844891927521489866 	
-0.0894124588338009868 	0.0731324460547871369 	
-0.0802259452050120558 	-0.0519833075584879359 	
-0.0551238771135205974 	-0.0166833765770412826 	
--0.0622929121394608376 	-0.0671272010662343349 	
-0.0474835827167428212 	0.100187705613688796 	
-0.00093000798044169631 	-0.0161573599883929851 	
-0.0273399367641181737 	-0.0290330689837868285 	
-0.00413171744220851723 	0.0540332392612201812 	
-0.028791614511517738 	0.101799784933123902 	
-0.0826043542511098877 	0.0595443398806073942 	
-0.0173455458441431273 	-0.0231609838112367648 	
--0.0651661292502417333 	-0.00342918868753603213 	
--0.0515443777867557601 	0.116355794605408527 	
-0.0144827874677999451 	-0.0484468599938595937 	
-0.0398492808382269678 	0.0570979506514010943 	
-0.0409422957513750074 	0.0235420170745705391 	
-0.123823341951995222 	0.10091216071522717 	
-0.0206465132491277202 	-0.0597036728917982387 	
--0.0529359164637621671 	0.0704150334686705764 	
--0.0278118235364679632 	0.0494262964446189682 	
-0.0229020530102890321 	-0.00377582992020663059 	
-0.0535701477025667394 	-0.0102037312692812975 	
--0.0122202124511695195 	-0.0359376052431937196 	
-0.0804612863629586006 	0.058542248866823382 	
-0.100029332597654591 	0.02112557311775402 	
-0.0947282024876038714 	-0.061817130326430561 	
--0.0361608425007227535 	0.0311597600002030302 	
-0.033589331722074095 	0.0528952996486044963 	
-0.071190814991817869 	0.0384182532433538018 	
--0.0435691714496959648 	0.0930188771008595983 	
--0.0487734141594259388 	-0.0300571805623113739 	
-0.0908582010256481359 	0.0518610318278819454 	
--0.0546603552684303898 	-0.0598059919892087524 	
-0.0592459967514932864 	-0.0174902679844622447 	
-0.0157480469652781785 	0.0746683855037197086 	
-0.0411546668201976593 	0.0183297061480632295 	
--0.0502342211515665743 	0.0438706616556866283 	
--0.00108104365159415847 	0.0456583592675194327 	
-0.0458590755068682826 	0.00765637767910260988 	
-0.0618399644264118406 	0.1145641396414291 	
-0.0462179880345139002 	0.0573603392953218605 	
-0.0104975017329301083 	0.122508935849065442 	
-0.0777597522532619961 	-0.0171644685587315667 	
-0.0895273088032630671 	0.106603464339333195 	
--0.0244515081029124913 	0.093896817245192013 	
-0.0814700453555974452 	-0.0242558864911008934 	
-0.015568792254542831 	-0.044246458089311512 	
+-1.21415711267087545 	-1.29354388830904199 	
+-1.24418997827235556 	-1.27717900530481843 	
+0.0690673896090493733 	0.00106171994505328718 	
+-0.0516350068945717125 	0.00282024601463587909 	
+0.11576289542965755 	0.0779696628865056002 	
+0.0937738356356867114 	-0.0213411066976067106 	
+0.0972995083962690521 	-0.020993689739654587 	
+0.125729266175554244 	0.0102265283424613773 	
+0.0763061532337257903 	-0.0398982061240517327 	
+-0.0404402347009997568 	0.0256125208841107184 	
+0.0915328264772420214 	0.0429378683671718595 	
+-0.0570336912737006846 	0.0526007297112317876 	
+0.102969530366209094 	0.119573904600153644 	
+0.0772888280315299769 	0.104255387702343258 	
+0.116394649377435544 	-0.00151413154731652386 	
+0.0426918411965738348 	-0.0187388372631490142 	
+0.00309655765104493259 	-0.00765739105447751315 	
+0.122622375403801082 	0.0780030163934584825 	
+0.0483846049070615694 	0.0210722938700518524 	
+0.125103439244352965 	0.0962171519640014489 	
+0.00709479590682871725 	-0.0237722892465301559 	
+-0.0227695901334794282 	0.0543427620501140685 	
+0.0687163096186778483 	0.0558421452465020091 	
+0.0873560612567313016 	-0.0280358619475561018 	
+-0.0464106966487873446 	0.0764830303301708425 	
+0.104489235992809307 	0.100178142145328428 	
+0.0776732347849002358 	0.0845290052909978551 	
+0.103692129703154029 	0.111410227121787497 	
+0.0430717292444947747 	-0.0217089627191627867 	
+0.0813883488134935357 	0.0210933819137022818 	
+0.129102379174570153 	-0.036355898240278843 	
+-0.0286792898569442622 	-0.034418242614459478 	
+0.0835488383450222472 	0.0702781455282296547 	
+-0.0580004135006431804 	-0.018560401134722463 	
+0.0855508878825002456 	0.106579346680886644 	
+0.0488784468778965461 	0.125566752615730415 	
+-0.0231226793861455185 	0.0787930530316436339 	
+0.114978759718911597 	-0.0154694984082932637 	
+-0.0386528393637206868 	-0.0209924608991451864 	
+0.0160783249246924942 	0.0627623210970354867 	
+0.0331228024081457323 	-0.0498308212634323566 	
+0.0582388085345983963 	0.0783366438529952969 	
+0.0406519677826411505 	-0.0288869980516132593 	
+-0.0597141338098050589 	0.126602072017401146 	
+0.0220616100720658487 	-0.0404334267520467042 	
+0.0907453618703057824 	0.115803257937635892 	
+0.015050429772469601 	0.0522433262471396487 	
+0.113094839239612374 	0.117470889171381862 	
+-0.00690135564924855734 	0.0928396049715910776 	
+0.109649827478102743 	0.0849798591361091427 	
+0.125891761693266185 	0.0650552724959696654 	
+0.117040829207718577 	0.112558749468915059 	
+0.127449941476074358 	0.0808065072573193877 	
+0.0919423334473952747 	0.0707898574066043729 	
+0.0858278120887288193 	-0.0534235543680405545 	
+0.0602800406259822799 	-0.0170601239435519865 	
+-0.053810352097996561 	-0.0635244256416778175 	
+0.0499377763793946508 	0.0982902763280064928 	
+0.00693050343376365886 	-0.0151916842537587263 	
+0.0331727775095305988 	-0.0296617801682230176 	
+0.00833280114998716931 	0.0539681702117705275 	
+0.031461760898633194 	0.100064949873964068 	
+0.0855326426254968963 	0.0573150170515133658 	
+0.0232074937816082634 	-0.0233352076821683845 	
+-0.0583191191212871565 	-0.000979764064585391878 	
+-0.0479906282582027513 	0.116284453036889127 	
+0.0210591810317722582 	-0.0477397138282999595 	
+0.0434376062540039742 	0.0561817288505665896 	
+0.0452950663181666685 	0.0224140022605995755 	
+0.125304222726260267 	0.0973538514926476223 	
+0.0273905390733705234 	-0.0593483422458846235 	
+-0.0482520815783283041 	0.0706049670949486785 	
+-0.0230148144711252271 	0.0495507483466000181 	
+0.0282514195131074453 	-0.00321472486741666928 	
+0.058562138849964078 	-0.0111312665818238624 	
+-0.00555360888280790905 	-0.0355896183418070028 	
+0.0834121315444082828 	0.0554918556198370494 	
+0.103621345570545725 	0.018758547809826151 	
+0.10042262676283964 	-0.0625169307095753413 	
+-0.0307622944804058357 	0.0317687524264961343 	
+0.0373219821352471087 	0.051103099269427181 	
+0.0747649366073993987 	0.0365997076737267432 	
+-0.0396251857033068436 	0.0922725594729125048 	
+-0.0415625864709825293 	-0.028102500526772628 	
+0.0938474228099761137 	0.0492258097438833461 	
+-0.0465543952870261582 	-0.0573943961338660089 	
+0.0642999004945939284 	-0.0190406742732633638 	
+0.0192566912094867988 	0.0737614039978816 	
+0.0456318762720610976 	0.0172826898145707966 	
+-0.0449514150475808227 	0.0440256246457320088 	
+0.00338020415539047082 	0.0453054325727234586 	
+0.0505121972965595842 	0.0063691522094812443 	
+0.0637718544343126165 	0.112154363518923827 	
+0.0496769642818689003 	0.0555319134645490958 	
+0.0129640742770456077 	0.121565282319786139 	
+0.0825645251590735596 	-0.018662570808792963 	
+0.0912876914719137483 	0.10330232917136499 	
+-0.0207879822675519077 	0.0935891931065968158 	
+0.0864228173229119323 	-0.0252615256322490621 	
+0.0219937469394293449 	-0.0441223905892084572 	
 ]
 ;
 gibbs_ma_schedule = []
@@ -178,11 +178,11 @@
 L1_penalty_factor = 0 ;
 L2_penalty_factor = 0 ;
 weights = 2  100  [ 
-0.0271770268163959439 	0.0118833632743686989 	-0.00567183938657645544 	-0.0122207159081185769 	0.00196703968088561424 	-0.0131871307588481545 	-0.00892209289428133948 	0.000382016486504915993 	-0.0113951924568277945 	-0.00585093153662755508 	0.00744281297629651589 	-0.0116827406646033746 	-0.00569917339709719376 	-0.00658761856403558554 	-0.0125259451659049063 	-0.00430789664331674132 	-0.0105012895359095013 	-0.00248565519413171268 	0.00553105072550596436 	-0.00133735576415962331 	-0.0134171089332170528 	-0.00174373254786221394 	-0.0112559224585996182 	-0.00754210768265164283 	0.00633225358760726616 	-0.00118360750914601109 	-0.00707090488205634488 	0.00867842576948034752 	-0.0120679581605469717 	0.00515519174812462989 	0.00213257697137463629 	-0.00341985592836731257 	-0.000913853605185472109 	-0.0129612052475874782 	0.00355828234669308468 	0.00217571437063262315 	-0.00798675155915287011 	0.00455899948219634903 	-0.00506996128930003662 	0.000864302092752470587 	-0.01538168!
 0630507797 	-0.00523932930549474325 	-0.00867158946199122344 	0.00832953846471989716 	-0.00567531768192584829 	0.0065341703955693357 	0.00165666561615662039 	0.00462577608129100676 	-0.00616213300233017097 	-0.00145209691614885464 	0.00331666123687043022 	0.0082927822995629754 	-0.00916247372360250861 	-0.01000665890875343 	-0.00198804500736899769 	-0.0141499548217935735 	-0.0163289104885140438 	-0.000224612284067136469 	-0.00641658948214465785 	-0.00215207968783769727 	-0.006146794807604836 	0.00491130416559766234 	9.9699742486728752e-05 	0.00287899745956593555 	-0.0104167021291508895 	0.00292131872693292315 	0.000828888102178114775 	-0.0108743647431252134 	-0.00330326912155650418 	-0.00816959717066418484 	-0.0101813215469680699 	0.00526732981175783224 	0.00550876147515752881 	-0.0123940959842866304 	0.0050859331672708126 	-0.000449498478426017117 	0.00522496838811247269 	-0.00877091022524515741 	-0.0166228475388693203 	-0.00298083568635761596 	0.0068917363590937095 	-0.00!
 966146905693430688 	0.00553281975457232261 	-0.009227553774756!
 57779 	0
.00560665134655017206 	-0.00883810802466983986 	0.00369251747582451974 	0.000624951594117463018 	-0.00261384737590105365 	0.0075725993816773314 	0.00361343289378807456 	-0.00383526337791708499 	0.00217883175220983261 	0.000405462871758497517 	-0.00816149311555905421 	0.00161163376829337197 	-0.00691594802986977668 	0.00576781734832231777 	-0.00767098255513799874 	-0.00225753983397914033 	
--0.0260088186242932173 	-0.00326705039709354345 	0.0109967870250136726 	0.00567865884841339125 	0.00806290728986782876 	-0.00358903722434102254 	0.0114315983077540803 	0.0108549621524123303 	0.00881984302161765987 	-0.00358860545303891403 	0.0102872105586720233 	0.00311387584594104844 	0.00437757876114128544 	-0.00263424981593723051 	0.00735861446686350215 	0.0131283715454847388 	0.00706551828015563634 	0.00180703778935793974 	0.0101549879837397085 	-0.00393291779091047532 	0.00859355060733783989 	0.00283885426494275093 	0.000452909471000893273 	0.0136331572197143577 	-0.00726271085644879591 	-0.00929058660215645142 	-0.00146328740716935007 	-0.00710602712833355039 	0.0118850655735111554 	0.00744209233606139484 	0.00166111517970999071 	0.00139277245136201636 	-0.00705175163512966087 	0.0147829526372095683 	-0.00835942597337547243 	-0.00288443271706440105 	-0.00832350679956405867 	0.00538543102831717975 	0.00772678412718929772 	-0.00693458908755236435 	0.0048453532451642467 !
 	0.0061483434122229421 	0.00773407409516880216 	0.00818963731714859346 	0.00676371328958364632 	-0.00598091327013947332 	-0.000551347532728718986 	0.00175597939459522191 	0.00189593788204031957 	-0.00806663744955274375 	0.00194209624913775419 	0.00141835122148731502 	-0.00623634929923983471 	0.00288075933589675755 	0.000700192765711378506 	0.00607443159434039627 	0.0126931545248905875 	0.00631835937368414695 	0.0144745347084638334 	-0.0038093562289958278 	0.00983646787560674835 	0.00622398741265053033 	0.00983906952817929434 	0.00691559781923365216 	0.0100686376348316908 	0.00262111546160444502 	0.0154553239022152886 	0.00542612232186331922 	0.0027648585864743472 	-0.000904840889969606328 	-0.00249769472184399252 	0.00144437082141045435 	0.00872105131920750468 	0.0140396168818688535 	0.0145520537386020828 	-0.00395021729067856174 	-0.00370482146031608913 	-0.000461407393780509986 	0.00610428245874079962 	0.00227089424795842492 	0.00109720581794125983 	-0.0004898432104734049!
 86 	-0.00874655700301532786 	0.00284620533340169827 	0.0093418!
 45737419
3041 	0.00139503068394781528 	0.00148661785326559054 	0.00852459347380386985 	0.00420354818371839432 	-0.00100296425400621088 	0.00946085517175728787 	-0.00186819800648357209 	0.00679791520833333222 	0.000728250640922994096 	0.00414452909907689696 	0.00963664401603184229 	-0.00955545536029932079 	0.00993500567498954018 	0.0108538796106596794 	0.00195167679720509735 	
+0.0569056865162901743 	0.0506708704397472176 	-0.00281005636301307577 	-0.00883585699550448571 	0.000968317251690560001 	-0.00934023592686317183 	-0.00511697102021179719 	0.00254076500836063809 	-0.00654591324086042751 	-0.00364155904253430198 	0.00817896291237938874 	-0.0107260314649677869 	-0.00859582448416375787 	-0.00872110586451122979 	-0.00976548188772112871 	-0.00033687045127778274 	-0.00688041685678250983 	-0.00350102615490139246 	0.00751567670499836849 	-0.00318769815895596437 	-0.00901948279713810086 	-0.00105238899124976588 	-0.0110583305687190249 	-0.00333929250749425864 	0.00606232293495695927 	-0.00317578753170242103 	-0.00827366343925372769 	0.00617556755864134225 	-0.00795541585758342655 	0.00698929690863082757 	0.0065417829948051457 	0.00169294246983757034 	-0.00144916085077765526 	-0.00849923651446167841 	0.00130887417565956113 	-0.000892816117790639924 	-0.00850108920620314644 	0.00801754174355075351 	-0.000575280972634687263 	0.000958759987538854185 	-0.!
 00981588084176744299 	-0.00608657171273093746 	-0.00418528552938027872 	0.00562735261577514568 	-0.000518050642663959635 	0.00384599591075757401 	0.00226942270388939913 	0.00182406737587419068 	-0.00745302084548695939 	-0.00275203624784231202 	0.0028967032650019371 	0.00571329210131102903 	-0.0103166826500750639 	-0.0106067278271120852 	0.0034960808896459957 	-0.0103525295822042684 	-0.00969075522674989545 	-0.00199977291888563807 	-0.00244342369869020607 	0.00242178409774834215 	-0.00559882884989377615 	0.00311628278103911376 	0.000164874834633516618 	0.00718502450411628076 	-0.00681132342906103257 	0.000672392566058983279 	0.006353803411059223 	-0.0105935035307277298 	-0.00137094737061349494 	-0.0100798145466800323 	-0.00410415532879708153 	0.00529336414233273073 	0.00643952878798065634 	-0.00912602857564504336 	0.00860528804414868211 	0.00461363049429684442 	0.00539813907327492751 	-0.00692511721474696734 	-0.0107749454556943496 	-0.0011298693980604567 	0.007461578090293!
 6189 	-0.00855606835453529349 	0.00444295613423474883 	-0.0043!
 67958872
62757861 	0.00603238991047171016 	-0.00251719714595639247 	0.00758185921101216503 	0.000155711332240578094 	-0.000431246983178083744 	0.00890166994818770464 	0.00461909965740889619 	-0.00113556307955706127 	-0.000295616485385759753 	0.00070233125797974276 	-0.0109428013806251619 	0.0053839440736755716 	-0.00903117295401473924 	0.00450712775405930251 	-0.00359892962931220289 	0.00308890717513798062 	
+-0.0557374783241875241 	-0.0420545575624722279 	0.00813500400145023526 	0.00229379993579922892 	0.00906162971906279702 	-0.00743593205632607068 	0.00762647643368445302 	0.00869621363055657348 	0.00397056380565017752 	-0.00579797794713223392 	0.00955106062258910884 	0.00215716664630538277 	0.00727422984820777323 	-0.000500762515461652285 	0.00459815118867967255 	0.00915734535344571443 	0.00344464560102859026 	0.00282240875012756401 	0.00817036200424728007 	-0.00208257539611419887 	0.00419592447125884897 	0.00214751070833023739 	0.00025531758112026467 	0.00943034204455691152 	-0.00699278020379851591 	-0.00729840657960003063 	-0.00026052884997202928 	-0.00460316891749462404 	0.00777252327054752876 	0.00560798717555513124 	-0.00274809084372059807 	-0.00372002594684294266 	-0.00651644438953755296 	0.0103209839040837199 	-0.00611001780234204147 	0.000184097771358786262 	-0.00780916915251383091 	0.00192688876696273255 	0.00323210381052388245 	-0.0070290469823388246 	-0.00072044654!
 3576197204 	0.00699558581945906952 	0.0032477701625577963 	0.01089182316609324 	0.0016064462503216899 	-0.00329273878532777712 	-0.00116410462046155259 	0.00455768810001197944 	0.00318682572519701952 	-0.00676669811785936097 	0.00236205422100616881 	0.00399784141973917508 	-0.00508214037276732457 	0.00348082825425537245 	-0.00478393313130366302 	0.00227700635475103479 	0.00605499926312637934 	0.00809352000850258567 	0.01050136892500937 	-0.00838322001458193834 	0.00928850191789566508 	0.00801900879720902557 	0.00977389443603241675 	0.0026095707746832497 	0.00646325893474177394 	0.00487004162247831052 	0.0099304085933341283 	0.00514526110946576277 	0.000832536835531273549 	0.00100537648604621423 	-0.00857486094001503295 	0.001418336490835488 	0.00779028400638433465 	0.0107715494732272214 	0.0110326988617241387 	-0.00901334626340150047 	-0.00387799214547862332 	-0.00230720040427873432 	0.000256380375565747564 	0.000419927959661202995 	0.000527364086741302185 	-0.0015952439128!
 724663 	-0.0076566933826778304 	-0.00201338956872734514 	0.008!
 91610717
349773998 	-0.00492588019476571277 	-0.00240272388192210766 	0.00899383373568070354 	0.0020209477909953655 	-0.00233203482051662705 	0.00845518840813633266 	-0.00456789830484366326 	0.00927236344592883947 	0.000431382254701681849 	0.00692583736414298379 	0.00586433371064961143 	-0.00744023043615439812 	0.0111956952692525424 	0.00678182668483380286 	-0.00339477021191207391 	
 ]
 ;
-bias = 2 [ -0.00864063821622487564 0.00864063821622500575 ] ;
+bias = 2 [ -0.0323078363819910008 0.032307836381991098 ] ;
 input_size = 100 ;
 output_size = 2 ;
 name = &quot;GradNNetLayerModule&quot; ;
@@ -194,7 +194,6 @@
  )
 *10 -&gt;SoftmaxModule(
 input_size = 2 ;
-output_size = 2 ;
 name = &quot;SoftmaxModule&quot; ;
 estimate_simpler_diag_hessian = 0 ;
 expdir = &quot;&quot; ;

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/global_stats.pmat
===================================================================
(Binary files differ)

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-0/split_stats.pmat
===================================================================
(Binary files differ)

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/Split0/final_learner.psave
===================================================================
--- trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/Split0/final_learner.psave	2007-05-30 15:46:36 UTC (rev 7428)
+++ trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/Split0/final_learner.psave	2007-05-30 15:59:19 UTC (rev 7429)
@@ -15,7 +15,7 @@
 ;
 gibbs_ma_increment = 0.100000000000000006 ;
 gibbs_initial_ma_coefficient = 0.100000000000000006 ;
-bias = 2 [ -0.00999999999999999674 -0.0100000000000000037 ] ;
+bias = 2 [ 1.17000000000000082 0.900000000000000577 ] ;
 input_size = 2 ;
 output_size = 2 ;
 name = &quot;RBMBinomialLayer&quot; ;
@@ -25,7 +25,7 @@
 seed = 1827 ;
 fixed_seed = 0  )
  )
-*4 -&gt;RBMBinomialLayer(
+*4 -&gt;RBMMultinomialLayer(
 size = 100 ;
 learning_rate = 0.0100000000000000002 ;
 momentum = 0 ;
@@ -33,116 +33,116 @@
 ;
 gibbs_ma_increment = 0.100000000000000006 ;
 gibbs_initial_ma_coefficient = 0.100000000000000006 ;
-bias = 100 [ -1.72690816138127623 -1.86856738093909391 0.0197459628563715316 0.0201484237238173762 0.0192178257276191602 0.0197481260903016043 0.0197147130066580786 0.0194881337812130261 0.0198675675955951245 0.0200388610885136181 0.0194875194982529268 0.0199649027024796782 0.0190775891699025979 0.0192569342652221288 0.0195638646775244708 0.0199204859522010141 0.0200171557622308323 0.0191839570013845086 0.0197529032771635998 0.0190631951000011304 0.0200630959071070175 0.0198679771586788151 0.0195215053265497852 0.0197791267146793619 0.0198970624819381214 0.0191313735813227782 0.0193520822709891023 0.0190559345778367716 0.0199237034942472239 0.019627400563694733 0.0196934866636073354 0.0202183474415308963 0.0193887335030357016 0.0202545819388921487 0.0191848740991793117 0.0192729492552097988 0.0197775218391521221 0.0196558155049876594 0.0202017557047582987 0.019707601859516765 0.0200673902532765847 0.019462645385585061 0.0199671202629631873 0.0197102656983617619 0.0200784721!
 963279088 0.0191065674569727804 0.0197510907818945203 0.0190059278352996477 0.0196458545492679999 0.0191910486460134984 0.0192269415887015953 0.0190018644952805876 0.0191451934475703606 0.0193610453293970204 0.0199154809001320272 0.019845388722619095 0.0204256833678869397 0.0194038830110665403 0.0200313319079572887 0.0200128142916943252 0.0197503975381724158 0.0194724317564281477 0.0194471609426532105 0.0200176791018486164 0.0201823883610635531 0.0197115811592959295 0.0201068834907110264 0.0196153633144061403 0.0197577047677771379 0.019080277899483241 0.020130670785645649 0.019903571685719882 0.019889944005649772 0.0199053609288379306 0.0198414193433427664 0.0201547070200743667 0.0194617444786761573 0.0195441779421063437 0.0198428125671930092 0.0199823233495897666 0.0196732796450470072 0.0195823206432603932 0.019814509406122463 0.02023615080955651 0.0194487186539949869 0.0203511338043818359 0.0198657768925716502 0.0196340243483772089 0.0197771097517825782 0.0199993915564294!
 737 0.0198141596164127694 0.0198080876423594662 0.019278405635!
 8570599 
0.0196014542659474732 0.0194392892256175891 0.0197830430159701177 0.0191885575637270253 0.0196988363499091511 0.0197771011880731214 0.020097121552294709 ] ;
+bias = 100 [ -4.32711526727717022 -4.3372701645486238 0.0884972513670912592 0.093104715836575605 0.0841804577845747803 0.0884423692492627839 0.0882859838041619716 0.0861706449956606002 0.0897606441010612016 0.0917997185462621212 0.0862172150073365617 0.0914492689853110274 0.0832344574341433024 0.0846255461316875041 0.0868979334356979743 0.0902140465230860805 0.0913138521627375882 0.0839526766363259125 0.0885437376916390906 0.0832835086330831614 0.0917704045377616684 0.0900370148671758574 0.0865570415437719454 0.0889061535637738626 0.0901933883949007226 0.0838551264647667549 0.0852683942355133145 0.0835320783360215119 0.0903033950528041307 0.0873495022725012532 0.0877663854611010485 0.0936361074968803386 0.0855698088882395069 0.09419432614006161 0.0842970734238651653 0.0849357771997706762 0.0891822142770180987 0.0874879941894524393 0.0935054566357249317 0.0882701258129414273 0.0917743293773878865 0.086154371844172295 0.0906792393721227302 0.0889428130004461526 0.091844875169!
 0769255 0.0838195887654502175 0.0886733457025641741 0.0829929657926603837 0.0880565159446428936 0.0841799095124265567 0.0842893022098406275 0.0830294042875595883 0.0837011826816979054 0.0852232267568197588 0.0899532197532659367 0.0894885518089337112 0.0958346480546612006 0.0857821218519718431 0.0914478410021243027 0.0910177787617019729 0.0888371373050060309 0.0863973972481843489 0.0859149352705648878 0.0911501112497726806 0.0935250257635063392 0.0888385233716558337 0.0921673857226443793 0.0874503485910435585 0.0886068150786280956 0.0832175599229860452 0.0923866976451308552 0.0904643653202136383 0.0902225674836392155 0.090163267675610545 0.0893460787478880109 0.0927602015627450316 0.0860875669223204326 0.0866369147670916218 0.0897427212560572424 0.0911794384643066641 0.0878912474958726958 0.0870217265658022876 0.089368170197947544 0.0939061363420257145 0.0859158022475398353 0.0952932285977265842 0.0894471842536392336 0.087739556635745064 0.0887800292092797427 0.0913084084576!
 754745 0.0893526585736332812 0.0890067708000333441 0.084833906!
 87493384
82 0.0872732569112319445 0.0863292264483929705 0.0887496467528825772 0.0841889624230460348 0.0885658836328168386 0.088839997890117095 0.0920015433771734364 ] ;
 input_size = 100 ;
 output_size = 100 ;
-name = &quot;RBMBinomialLayer&quot; ;
+name = &quot;RBMMultinomialLayer&quot; ;
 estimate_simpler_diag_hessian = 0 ;
 expdir = &quot;&quot; ;
 random_gen = *3   )
 ] ;
 connections = 1 [ *5 -&gt;RBMMatrixConnection(
 weights = 100  2  [ 
--0.851718783078528885 	-0.910486329990103593 	
--0.659504404042549841 	-0.689927144482110233 	
-0.0473467856084856115 	-0.021068362161156616 	
--0.0763279978440052492 	-0.024995950462423696 	
-0.0984925499563006623 	0.0605275928259499316 	
-0.0716186901981794716 	-0.0422369479917682616 	
-0.0751910597931305102 	-0.0426944682014643445 	
-0.105680817906009084 	-0.0085827564212096058 	
-0.0528534426101754801 	-0.0630143860776192916 	
--0.0636849713076504953 	0.000296357689145335113 	
-0.0722412690390428908 	0.0240000724194885731 	
--0.0795149766159689991 	0.0260226948687930157 	
-0.0872375303587325512 	0.102040194139168705 	
-0.060376224364312607 	0.0858482670524815805 	
-0.0955870795436864346 	-0.0218462836410353335 	
-0.019435312051865581 	-0.0426294654254820854 	
--0.0206292867336834371 	-0.033128250937456645 	
-0.105489209387850169 	0.0610132548278222372 	
-0.0271450136920915776 	-0.00044660786085679461 	
-0.108789594181019286 	0.0802701048382811894 	
--0.0173000567326795605 	-0.0498618595253241398 	
--0.044219471923943314 	0.0303278485818381967 	
-0.0494804976976577285 	0.0353764807397635092 	
-0.0646988703761498252 	-0.0504370704382912857 	
--0.0673594864781809771 	0.0535377668687243707 	
-0.0879440537180275345 	0.0839065049597001872 	
-0.0599101966215729378 	0.0656008493994736375 	
-0.0875922648250282848 	0.0959718080395012829 	
-0.0196611644974257899 	-0.0462472081457977954 	
-0.0609067028827928389 	0.00127671442019152565 	
-0.107088595556732571 	-0.0550986631886871137 	
--0.0544798253129736981 	-0.0609369658780364795 	
-0.0653062534020072 	0.0523544519516852616 	
--0.0839193988178982553 	-0.0480978780865896141 	
-0.068904105783615624 	0.0899580564424536377 	
-0.0322947301022608671 	0.107138399182431981 	
--0.043436963379607979 	0.0557648717257543877 	
-0.0935944351122741797 	-0.0344775581962125585 	
--0.0641051083594541271 	-0.0483468392439200048 	
--0.00398520248823383983 	0.0418393331889489392 	
-0.00816783017733600965 	-0.0752094319371216652 	
-0.0397745310771140045 	0.0579089760679177556 	
-0.0168776480209306239 	-0.0530314236971434899 	
--0.0787766678524840364 	0.102930259494416476 	
--0.00270357061388389313 	-0.0653815644783996702 	
-0.0745854071699557225 	0.0996238582913874793 	
--0.00553369828703782849 	0.0305331556619509135 	
-0.0974447119484660729 	0.101432571017619114 	
--0.0262128239015296458 	0.0700931771434041839 	
-0.0925637828825188469 	0.0685101012458730618 	
-0.108271194778608484 	0.0484393252355527701 	
-0.101252216065445516 	0.0969363346246270158 	
-0.110530703521969864 	0.0641959230652852791 	
-0.0738658245420108078 	0.0515677124424956945 	
-0.0620468833353416543 	-0.074840747418013831 	
-0.0375090557193314064 	-0.0403503520951321026 	
--0.0817606387545037755 	-0.0941729034033958329 	
-0.0321818621138092661 	0.0783374533923807126 	
--0.0170622345464189959 	-0.0409715664320675493 	
-0.00924487424224855296 	-0.0525350221800960221 	
--0.0124036714811625124 	0.0303416031292342014 	
-0.0133853651510562315 	0.0797999035478148405 	
-0.066731708589173433 	0.0378052583132586911 	
--0.000694041443434789272 	-0.047032436936468483 	
--0.0833886321511081163 	-0.0294395728849657992 	
--0.0672229874308973852 	0.0929396900921551222 	
--0.00408384461020086607 	-0.0731229680089544309 	
-0.0236341050880271575 	0.0341739394189243054 	
-0.0240390055038669122 	0.000654695542681125141 	
-0.10905230632212036 	0.0805994262143962387 	
-0.0018800063714631552 	-0.0841092760094767911 	
--0.0695684673535072184 	0.0465478713034307018 	
--0.0446867467803533369 	0.0255375579717537181 	
-0.00532884696606245045 	-0.0282093851102793065 	
-0.0360676011933133908 	-0.0333805715866888966 	
--0.030759113638008314 	-0.0602840912816266714 	
-0.0645296110380195603 	0.0375061656397878695 	
-0.0834963361937441501 	-0.000654235060203502312 	
-0.0764624808713148529 	-0.0853255088219337238 	
--0.0534727864403330491 	0.00678806315788592785 	
-0.0172211340480614497 	0.0306994595351846866 	
-0.054809120397035456 	0.0162128779226754262 	
--0.0596741528165589882 	0.0700626201021496003 	
--0.0674349405468486762 	-0.0557185492228891785 	
-0.0748798796287950819 	0.0304447538166093545 	
--0.0739848099856874886 	-0.0858825223223134426 	
-0.0416235953721035001 	-0.0401579333909238556 	
--0.000290140521490414474 	0.0518015871040411399 	
-0.0241467517440943462 	-0.00464756874856554064 	
--0.06740041521464471 	0.0199238484840746216 	
--0.0178350644969842778 	0.0221737351454135805 	
-0.0286613713778704447 	-0.0151538735374249535 	
-0.0469194243195553487 	0.0932551881994899134 	
-0.0300359815902802064 	0.035228160753480689 	
--0.00460449288331090788 	0.0999248768085001238 	
-0.060285603249684093 	-0.0398627181937667024 	
-0.0746180461743935902 	0.0860556995256641505 	
--0.040390121989510322 	0.070582859492072117 	
-0.0638836291961128039 	-0.0473970106832442423 	
--0.00292082644459958725 	-0.0684242089477991311 	
+-1.24792831633213641 	-1.39735089256445977 	
+-1.26139566256338598 	-1.38981579762817442 	
+0.0761048699587760225 	0.00801901792621092548 	
+-0.0437362423957267585 	0.0100258312296207294 	
+0.122341829544572858 	0.0843382980897796758 	
+0.100681906572919172 	-0.014297912333214367 	
+0.104194045090286055 	-0.0139423394592549255 	
+0.132369740996299834 	0.0170023995994674701 	
+0.0833785830127285188 	-0.0326773524247471192 	
+-0.0326950623956562547 	0.0326269485130347633 	
+0.0983250247890316426 	0.0495618447986045374 	
+-0.0492018798408611416 	0.0594823721799443497 	
+0.109567946177656472 	0.125725738863893627 	
+0.0840674972530368603 	0.110534760298992382 	
+0.123127060198002722 	0.00537144577668967425 	
+0.0499502891283985506 	-0.0115941354457338875 	
+0.0106130835455938329 	-0.000502204039447324223 	
+0.129155197592288162 	0.0843559859284681857 	
+0.0555094106422285502 	0.0279252235392405644 	
+0.131579496299484344 	0.102446402857112651 	
+0.014620781956967692 	-0.0165110880938397452 	
+-0.0152098035716024937 	0.0611314970453571208 	
+0.0756480514037247004 	0.0624429547810556387 	
+0.0943313046294627644 	-0.0209162148785304799 	
+-0.0387538020308657027 	0.0831676274390826531 	
+0.111079692147122572 	0.106413612787671669 	
+0.0844859003750914883 	0.0909281536163424886 	
+0.110255534107209494 	0.117569964096915225 	
+0.0503402481910374122 	-0.0145363440385552316 	
+0.0882877347052690303 	0.0278747608862448711 	
+0.13579989243262322 	-0.0293047418304829138 	
+-0.0208853376616612921 	-0.0270185613474963199 	
+0.0903303247636411122 	0.0767358706059570739 	
+-0.049995372117030687 	-0.0111852725638232134 	
+0.0922451774733284713 	0.112807474834139387 	
+0.0557920505124698887 	0.131762040536686248 	
+-0.0156166793851998647 	0.0854223662886001156 	
+0.121727203196954167 	-0.00852357251789233848 	
+-0.0308060743325063342 	-0.0136561429394114215 	
+0.0233263322247821737 	0.0694023941057379939 	
+0.0405156370159508172 	-0.0424488523830184247 	
+0.0652001999783928116 	0.0848180390433775633 	
+0.0479443611943429771 	-0.0216705924806779616 	
+-0.0520331275937088236 	0.133010909353283829 	
+0.0295060359707902987 	-0.0331018324098504776 	
+0.0973891803189232685 	0.121966636503981637 	
+0.0223348997781607182 	0.058958206082786728 	
+0.119610467943873061 	0.123597553887780973 	
+0.000476921336380212797 	0.09935506894421757 	
+0.116236242367810105 	0.0912979105807741331 	
+0.132418046816531965 	0.0714706742660448091 	
+0.123533091063945707 	0.118700555327761512 	
+0.133945660716787401 	0.0871316762245619159 	
+0.0986966479771140132 	0.0772562696165317586 	
+0.0928489721357925596 	-0.0461591939206654617 	
+0.0674164705057713337 	-0.00995972789837363745 	
+-0.0457363065061925367 	-0.0558365841657046738 	
+0.0569120685437913346 	0.104659972014240071 	
+0.0144387081701442752 	-0.00799004058277002355 	
+0.0405014545351480917 	-0.0224470511098674094 	
+0.0156885394621569529 	0.0607053011427125255 	
+0.0385488185786774309 	0.106453340415823924 	
+0.0923477123362821534 	0.0638716009610263702 	
+0.0305985475582649033 	-0.0161337302924452197 	
+-0.0503582362547266432 	0.00626888950394193043 	
+-0.0403763892900047203 	0.122732268245548823 	
+0.0285286154269412222 	-0.0403524371964778528 	
+0.0505460324818351181 	0.0628354760976757298 	
+0.0524402592962677425 	0.0292665783345892501 	
+0.131792667337911978 	0.103591992774134042 	
+0.0348344614551319917 	-0.0519031455810079895 	
+-0.0405527523441988128 	0.0773380740705313791 	
+-0.0154457459363229466 	0.0563698254393016143 	
+0.0355900832138369774 	0.00386744655745153596 	
+0.0656871478796531155 	-0.00408206902396727068 	
+0.00206405204327912055 	-0.0282454046662434892 	
+0.0902178471958940686 	0.0620365098886469582 	
+0.110386287835553543 	0.0255196613515526888 	
+0.107379950901278345 	-0.0551879644255911656 	
+-0.0230972154790073589 	0.0387229438492729394 	
+0.0444493219797162872 	0.0577741337594893933 	
+0.0816879272017193153 	0.0433059394724301938 	
+-0.0320513493983501305 	0.0988418390166333621 	
+-0.0336787933731876529 	-0.020710249645373352 	
+0.100614235785147138 	0.0558074948349462988 	
+-0.0385665850321436701 	-0.0497831257878785238 	
+0.0713897633525990144 	-0.011968020460012975 	
+0.0264864934157091371 	0.0803429688797962643 	
+0.0527857984995237089 	0.0241688198442964533 	
+-0.0372283475335263223 	0.0509203961830493809 	
+0.0107724740413416009 	0.0520979069590651045 	
+0.0576485034783195821 	0.0133097617517652107 	
+0.0706270442107162638 	0.118412798126190044 	
+0.0567206293871870618 	0.0621572219754824226 	
+0.0201604733232439125 	0.127871237627920936 	
+0.0895405314619520526 	-0.0116162226188489415 	
+0.0979661989894221319 	0.109552112759567388 	
+-0.0133191795274148917 	0.100124728352003464 	
+0.0933963703177931454 	-0.0181627406802816124 	
+0.0294391786966599553 	-0.0367752161076390013 	
 ]
 ;
 gibbs_ma_schedule = []
@@ -178,11 +178,11 @@
 L1_penalty_factor = 0 ;
 L2_penalty_factor = 0 ;
 weights = 2  100  [ 
-0.0456900587380019291 	0.0245575518707424854 	-0.00787214473654074612 	-0.0144743919701687575 	0.003496024170492237 	-0.0164240345594498273 	-0.0121502628167603106 	-0.00128306535776049561 	-0.0155748976480985808 	-0.00699205644423079101 	0.00730435919303305814 	-0.0115722489789861598 	-0.00223353065523180334 	-0.00382048438525061295 	-0.0147800584065648499 	-0.00750320039492726777 	-0.0132061484542741851 	-0.000952917610142818821 	0.00428468760423062357 	0.00104444514566430068 	-0.0168965649640248974 	-0.00148071584773325129 	-0.0108109172896363598 	-0.0111296359091801883 	0.0076515513123700191 	0.00139858820295143092 	-0.00524135437840637583 	0.0117917078134489196 	-0.0154149226815610829 	0.0039575041230261003 	-0.00175236529685367411 	-0.00740069864898183164 	0.000254878569183798667 	-0.016230091454807364 	0.00645167239735013921 	0.00596923371938500383 	-0.0065324676627502732 	0.00165449005757837284 	-0.00843120371078277288 	0.00160759006826828718 	-0.0200906994365848933!
  	-0.00372417615899771261 	-0.0123583423833368913 	0.0120522091749722358 	-0.00993040013420423175 	0.00985835547777058618 	0.00188191715919261079 	0.00799677897240793321 	-0.00401096360402066442 	0.00041797790804701555 	0.00425283064213270896 	0.0114374582274497927 	-0.00749862229653680372 	-0.00883113071265158832 	-0.00678771581774426178 	-0.0172447268249845097 	-0.0216725362040958332 	0.00224835650187098007 	-0.00948348415973260597 	-0.00586064468477759046 	-0.00587112469196224805 	0.00746429698472223391 	0.00063342642674797103 	-0.000542182068292089859 	-0.0128566063111055385 	0.0061612704193862132 	-0.0037802648213745558 	-0.0104466271686771608 	-0.00449082451869508952 	-0.00574541432502536156 	-0.0153351692812933871 	0.00628533199486186467 	0.00554164592581812485 	-0.0148688231922361573 	0.00228998032739363439 	-0.00446897815789715908 	0.00569235455558031629 	-0.0100577226560895662 	-0.0218694956985383687 	-0.00381810686570417494 	0.00709528973461256811 	-0.01013059812!
 564545 	0.00763370025022181136 	-0.0129220268062718441 	0.0057!
 69408150
86739341 	-0.0138888060056625295 	0.000536980749263159599 	0.00188445783641889289 	-0.00404991639092399346 	0.00732083219742387954 	0.00347621421153363093 	-0.00578595569835172168 	0.00532043203405586224 	0.000829490797610741779 	-0.00459639472482307673 	-0.00151166393570433119 	-0.00418868460561773459 	0.00793992751897048578 	-0.0111218875374863423 	-0.00667921801486887068 	
--0.0445218505458991332 	-0.0159412389934672043 	0.0131970923749779832 	0.00793233491046362038 	0.00653392280026122464 	-0.000352133423739276006 	0.0146597682302330862 	0.0125200439966778286 	0.01299954821288846 	-0.00244748054543561955 	0.0104256643419355297 	0.00300338416032387744 	0.000911936019275901965 	-0.0054013839947221658 	0.00961272770752349612 	0.0163236752970953025 	0.00977037719852038439 	0.000274300205369099655 	0.0114013511050151013 	-0.00631471870073437372 	0.0120730066381457557 	0.00257583756481384075 	7.90430203773942117e-06 	0.0172206854462429691 	-0.00858200858121141961 	-0.0118727823142538418 	-0.00329283791081928009 	-0.0102193091723020157 	0.0152320300945252909 	0.00863977996115996606 	0.0055460574479383358 	0.00537361517197657707 	-0.00822048380949889565 	0.0180518388444295304 	-0.0112528160240324537 	-0.00667795206581676872 	-0.00977779069596658272 	0.00828994045293516418 	0.0110880265486720791 	-0.00767787706306815015 	0.00955437205124142971 	0.0046!
 3319026572596611 	0.0114208270165145169 	0.00446696660689627906 	0.0110187957418620766 	-0.00930509835234066829 	-0.000776599075764645205 	-0.00161502349652165381 	-0.000255231516269149254 	-0.00993671227374859356 	0.00100592684387551317 	-0.00172632470639944241 	-0.00790020072630548062 	0.00170523113979497397 	0.00549986357608670332 	0.00916920359753138972 	0.0180367802404724602 	0.00384539058774607681 	0.0175414293860518648 	-0.000100791232055904255 	0.00956079775996422979 	0.00367099459352604723 	0.00930534284391807895 	0.0103367773470917045 	0.0125085418167863935 	-0.000618836230848810332 	0.0200644768257680212 	0.00499838474741526491 	0.0039524139836129811 	-0.00332902373560840792 	0.00265615301248140834 	0.000426368638306470499 	0.00868816686854697803 	0.0165143440898184272 	0.0173480065784792983 	6.92623887925698095e-05 	-0.00417220762778389067 	0.000825405037063947807 	0.0113509306184098688 	0.00310816542730503464 	0.000893652442422419434 	-2.07141417622024732e-05 	!
 -0.0108474374986647012 	0.0065406783649170578 	0.0091790889331!
 0217903 
	0.006445728664940557 	0.00464215457982702223 	0.00726508723150248812 	0.00563961719874139008 	-0.000751197069752700033 	0.00959807385401175057 	8.24943139511096976e-05 	0.00365631492648734987 	0.000304222715070786697 	0.000579430708340955471 	0.0127599417200296109 	-0.0122827187845512935 	0.00776289550434147019 	0.0143047845930080603 	0.00637335497809489362 	
+0.0532386934498691039 	0.080626291410914 	-0.00322832263047528618 	-0.00910343074055995106 	0.000362212364114244121 	-0.0097499114166556787 	-0.00553090895961826957 	0.00203960694798923942 	-0.00690742803008835993 	-0.00394282619132612332 	0.0076661302644176893 	-0.0110215495992722432 	-0.0092472474209955649 	-0.00930398259817479673 	-0.0102344772667839652 	-0.00069601406606644052 	-0.00720779799897976973 	-0.00411788273161691355 	0.00709460022217443288 	-0.0038394426807942519 	-0.00933301520711203071 	-0.0014059560481970222 	-0.0115574854661330828 	-0.00373112402975689155 	0.00573110929815871979 	-0.00379954945814822828 	-0.00882869991630134444 	0.00553558683983973367 	-0.008310844063386379 	0.00652472469292016567 	0.00612490476129661301 	0.00142932511701680137 	-0.00199249906965874969 	-0.00874289066291808817 	0.00070810547166986473 	-0.00145190000566321892 	-0.00887602388839884258 	0.00757538439212778435 	-0.00083985907401753579 	0.000533248145951293207 	-0.0101225850172!
 894268 	-0.00660073099196189974 	-0.00452815842694289251 	0.00528765362002427998 	-0.000826747184378847982 	0.00322234347196983508 	0.00185752294625763747 	0.0011579056263633172 	-0.00787045050184466237 	-0.00335996956149444206 	0.00229723571371282529 	0.00504812464862783306 	-0.0109458737169871017 	-0.0111640298400931398 	0.00314859000401088119 	-0.010733386362684583 	-0.0099049628398422615 	-0.00252614321577472253 	-0.00276674250666862241 	0.00208774392453802034 	-0.00600209242006417062 	0.00262090610153620576 	-0.000361770208588623127 	0.00685332269176408982 	-0.00706721837785403463 	0.000315119951773163635 	0.00605543728940713746 	-0.0110544512908535425 	-0.00178970847570510063 	-0.0107338376993417629 	-0.00439294534012347332 	0.00496981016904087317 	0.00609072055761557003 	-0.0094892060786338165 	0.00821754095252105222 	0.00432696950688535222 	0.00487749096412092194 	-0.00741430702567230215 	-0.0111183804980227972 	-0.00145075801315799045 	0.00701661058502487094 	-0.00!
 903557532195551488 	0.00408713070637454264 	-0.004623164359064!
 14726 	0
.00550622837347920779 	-0.00274284051463609098 	0.00719964435159268969 	-0.000287628302747019787 	-0.000843487492493124485 	0.00859268413927025132 	0.00423301492662385252 	-0.00153895089395540544 	-0.000865210986956572504 	0.000232639542571764704 	-0.0114273613766537781 	0.0049815735378366862 	-0.00963711400233785431 	0.00411475321119588767 	-0.0039944488654932624 	0.00278501374815411009 	
+-0.0520704852577663635 	-0.0720099785336388437 	0.00855327026891241488 	0.00256137368085467693 	0.00966773460663913203 	-0.00702625656653354299 	0.00804041437309091674 	0.0091973716909279548 	0.00433207859487812468 	-0.00549671079834038612 	0.0100638932705507927 	0.00245268478060984901 	0.00792565278503957853 	8.21142182019163135e-05 	0.00506714656774250906 	0.00951648896823437118 	0.00377202674322583238 	0.00343926532684308249 	0.00859143848707118879 	-0.00143083087427590722 	0.00450945688123279183 	0.00250107776527749891 	0.000754472478534290491 	0.00982217356681956699 	-0.00666156656700028684 	-0.00667464465315429408 	0.000294507627075601302 	-0.0039631881986930545 	0.00812795147635048294 	0.00607255939126580789 	-0.00233121261021206321 	-0.00345640859402216501 	-0.00597310617065646178 	0.0105646380525400863 	-0.00550924909835233834 	0.000743181659231372709 	-0.0074342344703180914 	0.0023690461183857041 	0.00349668191190673303 	-0.00660353514075127761 	-0.000413742368054!
 145467 	0.00750974509869004048 	0.00359064306012041789 	0.0112315221618441811 	0.00191514279203658074 	-0.00266908634654002041 	-0.000752204862829785074 	0.00522384984952284793 	0.00360425538155473507 	-0.00615876480420723092 	0.00296152177229528409 	0.00466300887242236325 	-0.004452949305855298 	0.00403813026723639362 	-0.00443644224566854158 	0.0026578631352313759 	0.00626920687621874539 	0.00861989030539164758 	0.0108246877329877689 	-0.00804917984137160786 	0.00969176548806604046 	0.0085143854767119314 	0.0103005394792546022 	0.00294127258703543674 	0.0067191538835347734 	0.00522731423676414068 	0.0102287747149861774 	0.00560620886959162148 	0.00125129794062288292 	0.00165939963870793614 	-0.00828607092868862208 	0.00174189046412734599 	0.00813909223674941923 	0.0111347269762160014 	0.0114204459533517721 	-0.00872668527598998399 	-0.00335734403632461254 	-0.00181801059335338347 	0.000599815417894182979 	0.000740816574758738585 	0.000972331592010053391 	-0.00111573694545!
 227136 	-0.00730086795481763896 	-0.00175818408229077715 	0.00!
 94422687
1049019811 	-0.00470023682608601296 	-0.00202050902250264274 	0.00943717337066829129 	0.00243318830031040434 	-0.0020230490115992106 	0.00884127313892139541 	-0.00416451049044531257 	0.00984195794749967087 	0.0009010739701096563 	0.00741039736017155316 	0.00626670424648849596 	-0.00683428938783131341 	0.0115880698121158966 	0.00717734592101487798 	-0.00309087678492820641 	
 ]
 ;
-bias = 2 [ -0.00668158134821025037 0.00668158134821048195 ] ;
+bias = 2 [ -0.0480886388473655974 0.0480886388473659929 ] ;
 input_size = 100 ;
 output_size = 2 ;
 name = &quot;GradNNetLayerModule&quot; ;
@@ -194,7 +194,6 @@
  )
 *10 -&gt;SoftmaxModule(
 input_size = 2 ;
-output_size = 2 ;
 name = &quot;SoftmaxModule&quot; ;
 estimate_simpler_diag_hessian = 0 ;
 expdir = &quot;&quot; ;

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/global_stats.pmat
===================================================================
(Binary files differ)

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-1-1/split_stats.pmat
===================================================================
(Binary files differ)

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/Split0/final_learner.psave
===================================================================
--- trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/Split0/final_learner.psave	2007-05-30 15:46:36 UTC (rev 7428)
+++ trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/Split0/final_learner.psave	2007-05-30 15:59:19 UTC (rev 7429)
@@ -15,7 +15,7 @@
 ;
 gibbs_ma_increment = 0.100000000000000006 ;
 gibbs_initial_ma_coefficient = 0.100000000000000006 ;
-bias = 2 [ 6.07153216591882483e-18 0.0100000000000000019 ] ;
+bias = 2 [ 0.0566666666666666707 0.0600000000000000047 ] ;
 input_size = 2 ;
 output_size = 2 ;
 name = &quot;RBMBinomialLayer&quot; ;
@@ -25,7 +25,7 @@
 seed = 1827 ;
 fixed_seed = 0  )
  )
-*4 -&gt;RBMBinomialLayer(
+*4 -&gt;RBMMultinomialLayer(
 size = 100 ;
 learning_rate = 0.0100000000000000002 ;
 momentum = 0 ;
@@ -33,116 +33,116 @@
 ;
 gibbs_ma_increment = 0.100000000000000006 ;
 gibbs_initial_ma_coefficient = 0.100000000000000006 ;
-bias = 100 [ -0.624167740881101829 -0.628444411625437627 0.000709957644041790919 0.000740683506470504434 0.000478739580500094498 0.000765665323817401287 0.000763074456502417769 0.000666671215131671132 0.000822856708528673514 0.000670829999984351791 0.000583648070656796691 0.000599479894099917677 0.00036872361866499727 0.000415578264653740869 0.000702592721826526866 0.000773744314404547682 0.000754423879452146358 0.000475958981329634482 0.000658587437521452311 0.000421151755244786124 0.000799414913590407996 0.000585128243831590632 0.000555592743822259471 0.000785962055649062474 0.000530712513986629541 0.000414209842133454135 0.000471230049648720302 0.000379159162836442687 0.000782517789744470167 0.000648562141539212739 0.000800241382189730639 0.000835003863211115829 0.000506667775580617666 0.00080621235926479364 0.000401079091955887281 0.000361629965580924004 0.000516041840928470265 0.000743326760905365074 0.000802770681513981276 0.000549188266993898278 0.0008643275704699874!
 59 0.000495304399400214737 0.000802828978976741041 0.000389920145033558602 0.000840224294026908382 0.000372811311273746327 0.000579643564976479032 0.000365163755140393142 0.000471233630352001762 0.000456218140546750821 0.000509399790306168171 0.000375572155279322727 0.000466134144499274897 0.000507577396210744818 0.000859977308868474684 0.000763772552741912264 0.00093307263365882871 0.000440521008124671813 0.000775077107182792907 0.00080532920412775726 0.000578165026241416326 0.000439892674170279873 0.000546265778021677996 0.000790776524022009358 0.000753989384968865861 0.000416401182775914304 0.000861313105575927285 0.000562390295982260254 0.000655856295563808905 0.000422713181663475024 0.000891131180297196203 0.000546792031441616826 0.000598699934351909599 0.000735434999588331466 0.000747037195561638155 0.000830567756844462148 0.000548241827323441076 0.000649121401401696069 0.00087825903004364091 0.00065116203684796451 0.000575725153135923343 0.000607524239249439182 0.000!
 484607601265854017 0.000823157929298029079 0.00056533604220679!
 063 0.00
0904580619502292987 0.000767353760932779159 0.000518408526618136401 0.00067033046522506942 0.000620053336001233964 0.000603321123485129869 0.000699289901204349501 0.000397381439707222546 0.000560228656808030669 0.000384419879320751622 0.000761366899672675308 0.000411833412452962963 0.000473025180495118653 0.000778589604058810888 0.000849366214601741921 ] ;
+bias = 100 [ -3.67929816976774804 -3.66824487525477094 0.0750909232339263683 0.0795841166700319153 0.0708342668804167186 0.0750421938062638266 0.0749057540871664318 0.07281350621284427 0.0763556633275116886 0.0782689083009728281 0.0728246431246861031 0.0779183009350939149 0.069900033259396116 0.0712420215383051392 0.073542444248528932 0.0767792116507820116 0.0778439304287265044 0.0706109057057301009 0.0751034493617696725 0.0699400576141234881 0.0783087691931432239 0.0765286316068690131 0.073159353333281496 0.0755157467085580958 0.0766351376284479802 0.070479449352692139 0.0718806226985668067 0.0701457067916425731 0.0768776599755876117 0.0739384583091209358 0.074377412917112945 0.0801217793115618082 0.0721628274764351402 0.0806814897703578837 0.0708951835495260363 0.0715097933984782524 0.0756688379895598257 0.0740952778784406269 0.0799916253106679881 0.0747857117152906786 0.0783304419111606337 0.0727520148249376497 0.0772393904668482317 0.0753918317216105277 0.07838219159449!
 7691 0.0704261841624362062 0.0751946302171443148 0.0696449037214908473 0.0745767703531106385 0.070806479283302623 0.0709348311649994623 0.0696759908129132854 0.0703636071845372274 0.0718591719674553236 0.0765280528752297073 0.0760744758082740474 0.0823326087023871639 0.0723685391237849779 0.0779853133866276194 0.0775462066951605328 0.0753792470513584278 0.0729536446087890034 0.0725329279936358651 0.0776784049340394911 0.0800016351796151021 0.0753005795642522208 0.0787062629788652796 0.0740323485729651315 0.0751659610584929916 0.0698937309834748721 0.0789209919201119547 0.0769177427996143859 0.0767115469459719035 0.076730475615456234 0.0759158170119265813 0.079254120119077634 0.0726706650970279228 0.0732572878386490711 0.076356245513700613 0.0776622930565265546 0.0744300500286751571 0.0736199596196006334 0.0758170804080609134 0.0803895298645544015 0.0725294734781802286 0.0817744617003312163 0.0760032369969883548 0.0742856132339138608 0.0753395223184903928 0.07775838377451359!
 25 0.0758727019124877528 0.075561348375963483 0.07143844998902!
 13659 0.
0738360175084723652 0.0728876094213855852 0.0753375538997586996 0.070809484771196099 0.0750639894616385306 0.0754455419716839742 0.0785276661645328 ] ;
 input_size = 100 ;
 output_size = 100 ;
-name = &quot;RBMBinomialLayer&quot; ;
+name = &quot;RBMMultinomialLayer&quot; ;
 estimate_simpler_diag_hessian = 0 ;
 expdir = &quot;&quot; ;
 random_gen = *3   )
 ] ;
 connections = 1 [ *5 -&gt;RBMMatrixConnection(
 weights = 100  2  [ 
--0.270942380180766718 	-0.344951203098753545 	
--0.266734680918452483 	-0.288100577727520069 	
-0.0388637143262277746 	-0.0242391885614905642 	
--0.0857020966254142952 	-0.0242097609516870975 	
-0.0879330246336544746 	0.0553159827141755794 	
-0.0640232162503140967 	-0.0469162138295738246 	
-0.0676311878996795068 	-0.0465260674938290791 	
-0.0973248237695909374 	-0.0140562928748333271 	
-0.0457422867398990379 	-0.0662651660059198067 	
--0.0737372585066995018 	-0.000567381063581012682 	
-0.0625853738904373624 	0.0190858264336108002 	
--0.0905237066272642638 	0.0269254176423930174 	
-0.0752740553491753339 	0.0977821756827448596 	
-0.0486974561217509219 	0.081781857361321264 	
-0.0875470131323612399 	-0.026248308878143705 	
-0.0113955752510758977 	-0.0449756571025992508 	
--0.0293028495450103239 	-0.03415745771254413 	
-0.0949872353987274431 	0.0554350790099057758 	
-0.0178574723852600696 	-0.00394757830250162031 	
-0.0977675209744450213 	0.0741308331636651857 	
--0.0254256956936544896 	-0.0506894775104097181 	
--0.0550720954989905101 	0.0292290089066191347 	
-0.0392457577048070383 	0.0320207915816171085 	
-0.0572915863271437689 	-0.0539068479838478859 	
--0.0791122444278429676 	0.0516504726090754041 	
-0.0766431478294858637 	0.0779453108135638173 	
-0.0488447985333031395 	0.0615664330856188699 	
-0.0759728128159506827 	0.0894447259633791292 	
-0.0117280247280795013 	-0.0480347929531337314 	
-0.0518603982585079462 	-0.00347256410548491164 	
-0.100212043415836727 	-0.0618529178450820949 	
--0.0625121343020074577 	-0.0621924075688494796 	
-0.0547396628209017855 	0.0470391625297908247 	
--0.0926482292623610898 	-0.0463398746832383718 	
-0.0572587082373226461 	0.0842763188671842717 	
-0.0197490021249463084 	0.103270958444139027 	
--0.055077990766125233 	0.0543424119200461853 	
-0.0859539833736863157 	-0.0405791995470774006 	
--0.0726337133560373549 	-0.0485255223087516022 	
--0.0148406268530640525 	0.0384374454628322662 	
-0.00105906167607026859 	-0.0771270365357257931 	
-0.0287497955838862153 	0.0549620005734926947 	
-0.00914724852218390047 	-0.0554463666095900906 	
--0.0921934992176862145 	0.102896294178221853 	
--0.0101988308629374635 	-0.0676060516051632809 	
-0.0627108619271047885 	0.0937874379467016905 	
--0.0160597155054533307 	0.0276160665371663269 	
-0.0856795437194884379 	0.0957550895155522136 	
--0.0381752892496052612 	0.0689763187154760482 	
-0.0817622238906748344 	0.0624348606737036849 	
-0.0982032775447262835 	0.0422075662767886287 	
-0.089684109141982965 	0.0907736103948103695 	
-0.0999843950086458655 	0.0583673596750265561 	
-0.0633352419086829904 	0.04765295952037224 	
-0.0554059096708360496 	-0.0800188032273179833 	
-0.0295471458277952424 	-0.0429996290238920664 	
--0.0890432607306408386 	-0.0926370134983343502 	
-0.0204701147874546269 	0.0753207115726070575 	
--0.0254646036929875898 	-0.0418578609301537008 	
-0.00146494080697637382 	-0.0563301102852772281 	
--0.0230148660644481501 	0.0292738544118497437 	
-0.00147980628717204565 	0.076906408266775278 	
-0.0565781091765761301 	0.0337529299626861679 	
--0.00873965141604447424 	-0.0499749617272031224 	
--0.0926820388169885129 	-0.0282296424406375951 	
--0.0802299610139603353 	0.0924744558237974579 	
--0.0113496430518221624 	-0.0751493373965541611 	
-0.0132031628128983398 	0.032028047377664591 	
-0.0146878946461903928 	-0.00261372880999629405 	
-0.0979673608782071215 	0.0752925738153985974 	
--0.00497310947224809292 	-0.0870017584796564797 	
--0.081129214374221062 	0.0455757001084827959 	
--0.0553896822406944184 	0.0243027412935575143 	
--0.00330022021878153063 	-0.0292273990178151047 	
-0.0278873872369030384 	-0.0369120147632706203 	
--0.0386068031364391467 	-0.0630242320858237642 	
-0.0544188689721371022 	0.0318739854643987977 	
-0.0746981793434075281 	-0.00558211826848537592 	
-0.0702647334480628327 	-0.0892022955767905329 	
--0.0636550567006622381 	0.005907096900115919 	
-0.00689270507994843747 	0.0267558945203507405 	
-0.0452282400418266006 	0.0123528612538514691 	
--0.0718809443439683976 	0.067962759667755876 	
--0.075753601497175041 	-0.0558970264471046543 	
-0.0650450254330087463 	0.0255668829957886451 	
--0.0813893405372911327 	-0.086178144808681259 	
-0.0337199226663871185 	-0.0449478685466619607 	
--0.0114594861396921377 	0.0497542528930018657 	
-0.0149623513698479756 	-0.00788254557646375642 	
--0.0780924730018022484 	0.0183111387298994753 	
--0.0282156027554618383 	0.0203167089313730925 	
-0.0198541045032977967 	-0.019024218410777477 	
-0.0348868353182193655 	0.0897070785069127019 	
-0.019664449458248464 	0.03146223660785262 	
--0.0173303496509589899 	0.0986967584407118514 	
-0.0525189218463548851 	-0.0443158762729733632 	
-0.0630974315201286995 	0.0809823783794581809 	
--0.0524788385094511756 	0.0695587406389335389 	
-0.0563754106915492145 	-0.0510627812270150472 	
--0.010304599328406331 	-0.0713954062218518232 	
+-0.520385419257819781 	-0.607667740189380523 	
+-0.547335303272597051 	-0.574510722075016744 	
+0.0504029420063143579 	-0.0174374020209189066 	
+-0.0726720177154327324 	-0.0166870493884907455 	
+0.0985284220175968173 	0.0611863005277123242 	
+0.0754034367023085489 	-0.0400349156555762711 	
+0.0789734219571437829 	-0.0396774616380166784 	
+0.108170790392739927 	-0.00765013072823587503 	
+0.0574395119975671942 	-0.0591070156090361884 	
+-0.061007039891299214 	0.00667184762083029067 	
+0.0736287540104566957 	0.0253895592031331205 	
+-0.0777417566768631441 	0.033988152696632544 	
+0.0857932600234043719 	0.10336889613750673 	
+0.0595732996791215608 	0.0876320649751073794 	
+0.0985639370941749221 	-0.0196922373217131783 	
+0.0233660805474359655 	-0.0378252019980260187 	
+-0.0169121891224506757 	-0.0268755261362537863 	
+0.105509436301355383 	0.0612729979063185298 	
+0.0295185514598919028 	0.00279503185259740924 	
+0.108172318468795839 	0.0798166168810517801 	
+-0.0129827416114516904 	-0.043273012491637404 	
+-0.0427436926119571375 	0.0360769453606456375 	
+0.0504779492722270892 	0.0383236706034821711 	
+0.0687895317968882092 	-0.0469326547384686793 	
+-0.0666313507642620623 	0.0584517370219266724 	
+0.0872457685108091324 	0.0837080805890952351 	
+0.0598201510048938442 	0.0675784349064649376 	
+0.0865288471252173008 	0.0951316360468640737 	
+0.0237140180718280573 	-0.0408629407609415601 	
+0.0631379942820747275 	0.00308499348420874066 	
+0.111272744450818944 	-0.0550198793991546892 	
+-0.0495399255127684443 	-0.0544110084214884521 	
+0.0657230040930184001 	0.0531562468007424349 	
+-0.0793895470235106288 	-0.0385651446308253806 	
+0.0680320003763357217 	0.0900858662837026314 	
+0.0308277344266279299 	0.109102377743976534 	
+-0.0428935242523314705 	0.0609697782115297265 	
+0.0970561821731235064 	-0.0338666308471151228 	
+-0.0596192092162303872 	-0.0408316442859519985 	
+-0.00304223746333419842 	0.0449917804586676198 	
+0.0133410948519769677 	-0.0696020236616901877 	
+0.039977823239458643 	0.0611241954582473629 	
+0.0212044378814250332 	-0.0481804311018778769 	
+-0.0798320840154110589 	0.109307593668522079 	
+0.00216013628189292914 	-0.0601016310390021097 	
+0.0733821940828805058 	0.099497308314277666 	
+-0.00418577457569986513 	0.034267274973199667 	
+0.0961049167980579933 	0.101328682742033521 	
+-0.0262656255829718105 	0.0753752819357316889 	
+0.0923863548467529772 	0.0682949741016277007 	
+0.108756281771888105 	0.0481458386888888659 	
+0.100093215436711416 	0.0963736142319992356 	
+0.110441408196684354 	0.0641597539760613289 	
+0.0742272888131287473 	0.0536989130170025392 	
+0.0670662090171207786 	-0.0727680558490813728 	
+0.0412975622692688671 	-0.0359736262889523289 	
+-0.07553369573227528 	-0.0843988974337768205 	
+0.031683218853364746 	0.0813611862515050827 	
+-0.0130739435676640071 	-0.0345269882482395971 	
+0.0136140272169084781 	-0.0489930421672095315 	
+-0.0110617238790147124 	0.0359297344246217523 	
+0.0128932585850817134 	0.0830364377215482702 	
+0.0676125872825022595 	0.039953970286474183 	
+0.00349451945220510905 	-0.042645481572695855 	
+-0.0795372606084337602 	-0.0206274492374718503 	
+-0.0679556269290350762 	0.0989090112668678245 	
+0.00106926327384114094 	-0.0675641733945039902 	
+0.0247260524176569838 	0.0384630055092971893 	
+0.0263782253284606909 	0.00413268501827161912 	
+0.108363320390186396 	0.0809527489082843138 	
+0.00744067734895160083 	-0.0793276345356500878 	
+-0.0685828648959103254 	0.0524331672735785029 	
+-0.0430299179219996233 	0.0311991517220432529 	
+0.00875455007682278755 	-0.0221527377393929692 	
+0.0396190903019199014 	-0.0299243858711141751 	
+-0.0259299398002285457 	-0.0553743962254750755 	
+0.0654815998567056939 	0.0381233449386994203 	
+0.0857406226041131786 	0.000868266886166540347 	
+0.0818156967821113135 	-0.0819606571238428866 	
+-0.0510867284702254815 	0.0130209282921754654 	
+0.0185073534397708732 	0.0332937538289315854 	
+0.0564972252169523848 	0.0187982842748549012 	
+-0.0595800360354162978 	0.0745776702050969659 	
+-0.0626526219961449915 	-0.0481068295040314869 	
+0.0760290724928658762 	0.0318015323295316593 	
+-0.0680175615269424105 	-0.0780292036804604849 	
+0.0454265273931732799 	-0.0379064295013739685 	
+0.000245257330670842243 	0.0561754669591406422 	
+0.0266789063222490318 	-0.00109026801003190839 	
+-0.0654262101077237451 	0.0254095633358379092 	
+-0.0161558737254881811 	0.0270927473390010463 	
+0.0315749936922243846 	-0.0121516449151251368 	
+0.0458707558030447271 	0.0955607640219145738 	
+0.0311126203336938266 	0.0378846159519728512 	
+-0.00581538096481792107 	0.104733200172821811 	
+0.0640125283786390359 	-0.0373943635204284225 	
+0.0738255534250779194 	0.0867777875959012679 	
+-0.0404066042800288877 	0.0760341306135597778 	
+0.0678668982597476489 	-0.0441082122306330204 	
+0.00207766362528058642 	-0.0638437672563030162 	
 ]
 ;
 gibbs_ma_schedule = []
@@ -178,11 +178,11 @@
 L1_penalty_factor = 0 ;
 L2_penalty_factor = 0 ;
 weights = 2  100  [ 
-0.0129363155418188869 	0.00722682339533198704 	-0.00128403158612670916 	-0.00761510938418461826 	0.00267662878895560952 	-0.00778259217407239329 	-0.00354962342934044949 	0.00421475187823501692 	-0.00505567414476116358 	-0.00237495704756130344 	0.00980469446883564487 	-0.00948551444410744571 	-0.00689158887978083383 	-0.00707824493512899597 	-0.00812676855163213183 	0.00110009490362713235 	-0.00552864235450231754 	-0.0017785455820846 	0.00901242417270013696 	-0.0014518198603007907 	-0.00767435436940648846 	0.000288532233135385219 	-0.00947454657252504162 	-0.0018057144631257278 	0.00735255099336633213 	-0.00147889609864421969 	-0.00664421648815203322 	0.00787600402926930641 	-0.00652078325797752264 	0.00856795954987436825 	0.00816407996165207164 	0.00294270899881390229 	0.000181659888084517414 	-0.00730692596132298186 	0.00297006469457330134 	0.000700975146671353072 	-0.0071390226318940337 	0.00963420146527739323 	0.000661525004117154256 	0.00241402777580159182 	-0.00844012!
 963460597822 	-0.00450774351767037687 	-0.00276582976630487939 	0.00692215246020637907 	0.000843284357457251867 	0.00552318932231998794 	0.00371192372319035374 	0.00354550264936769489 	-0.0060309090799447523 	-0.00105304729649743781 	0.00461782263603692338 	0.00743998707930599613 	-0.00858294414230608566 	-0.00895511442120990042 	0.00498804189241739381 	-0.00887035789977102043 	-0.0085117618296494512 	-0.000424265297179427393 	-0.00108973181826476717 	0.00382131799807784289 	-0.0041715689637498261 	0.00464731214692556266 	0.00179013115346258328 	0.00856842519866737179 	-0.00561025597512739439 	0.0019945935555229651 	0.00770436319355811711 	-0.00907200219488839971 	0.00011954715915946264 	-0.0083424901053764846 	-0.00275395880802577599 	0.00657357523960835043 	0.00777533317764897772 	-0.00770598474762558289 	0.0100900526255243029 	0.00591528177456377043 	0.00701562454778071037 	-0.00529478936030245567 	-0.00926152183574089488 	0.000168740873684036807 	0.00896105997278937721 !
 	-0.00697668799502107993 	0.00576775049429954171 	-0.003143096!
 31130888
639 	0.00766951284502495612 	-0.00132170392455150092 	0.00906998239884374176 	0.00163102122374250442 	0.00105448044942331367 	0.0101695170606597562 	0.00602388619829060962 	0.00034976202919992708 	0.001322818606089563 	0.0022380270430986649 	-0.00943962558668744699 	0.00691772650985243449 	-0.00735934085366255798 	0.00589006497983871665 	-0.00206397316016543016 	0.00444525242249854333 	
--0.0117681073497162472 	0.00138948948194310396 	0.0066089792245639014 	0.00107305232447938532 	0.007353318181797781 	-0.00899357580911680672 	0.00605912884281313135 	0.00702222676068221634 	0.00248032470955095261 	-0.00706457994210517824 	0.00792532906613291864 	0.000916649625445037949 	0.00556999424382487868 	-0.0021436234448438422 	0.00295943785259068478 	0.00772037999854081631 	0.00209287109874841705 	0.0010999281773107928 	0.00667361453654552548 	-0.00381845369476934132 	0.00285079604352725738 	0.000806589483945112525 	-0.00132846641507370364 	0.00789676400018838459 	-0.00828300826220786622 	-0.0089952980126582309 	-0.00188997580107371486 	-0.00630360538812256566 	0.00633789067094164826 	0.00402932453431162092 	-0.00437038781056752618 	-0.00496979247581925705 	-0.00814726512839968227 	0.00912867335094501298 	-0.00777120832125572595 	-0.00140969349310317814 	-0.00917123572682289855 	0.000310229045236122005 	0.00199529783377207009 	-0.0084843147706015129 	-0.0020961977507!
 3762197 	0.00541675762439853669 	0.00182831439948242906 	0.00959702332166203868 	0.00024511125020050355 	-0.00496993219689013249 	-0.00260660563976248399 	0.00283625282651849431 	0.00176471395965486447 	-0.00846568706920421826 	0.000640934849971215711 	0.00227114644174425742 	-0.0068158788805363045 	0.00182921484835318979 	-0.00627589413407504508 	0.000794834672317848868 	0.00487600586602596198 	0.00651801238679640578 	0.00914767704458396835 	-0.00978275391491139137 	0.00786124203175170115 	0.00648797943132260573 	0.00814863811720340642 	0.00122617008013219076 	0.00526219148080815657 	0.00354784063301436577 	0.00857984881083526801 	0.00362375977362648432 	-0.000657957694241655838 	-0.000731947955257309822 	-0.00992505746078632331 	0.000138125393559896054 	0.00645447961671602628 	0.00935150564520778257 	0.00954793428034852835 	-0.0103149975436683822 	-0.00549547761998434893 	-0.00393752825872322083 	-0.00125704324438766484 	-0.000878682312083264925 	-0.000972117795754441172 !
 	-0.00317462427238668701 	-0.00898148774274258078 	-0.00323825!
 21300460
1264 	0.00727898423894446887 	-0.00612137341617055922 	-0.00389084706975364883 	0.00751852384417880156 	0.00053522035839399329 	-0.00359988193298867425 	0.00705040186725465912 	-0.00605322341360061984 	0.00765392835445357668 	-0.00110431353041721319 	0.00542266157020528192 	0.00433055127447276068 	-0.00911206253650654815 	0.00981275804347311181 	0.00524687021568705659 	-0.00475111545927262187 	
+0.0113262925564693046 	0.00641492602461607182 	-0.00159847381051862942 	-0.00789459485609226956 	0.00244219358215985944 	-0.00812615500197023596 	-0.00389482222121642196 	0.00389091998488833198 	-0.00541050652884287209 	-0.00262556755390811651 	0.00952868237595928119 	-0.00969494151094163654 	-0.00706508174692422036 	-0.00727612306607582256 	-0.00846038975666717902 	0.000773966054525185103 	-0.00583361570628981082 	-0.00201278590637816524 	0.00872572454424036872 	-0.00165701502752675081 	-0.00799891102918076635 	6.47096589051986929e-05 	-0.00973055555769559467 	-0.00215375660638213347 	0.00716715790392904832 	-0.001680404187211998 	-0.00686749154366765591 	0.00769175181889198388 	-0.00685037181174525441 	0.00827079361448006603 	0.00779395048534614783 	0.0026080574091930527 	-5.93787847705065132e-05 	-0.0076190130320924563 	0.00277648344971009181 	0.000531124508030603811 	-0.00733566395363501739 	0.00928862170370055307 	0.000345824306290504408 	0.00218347321736047728 	-0.008!
 79584583154094032 	-0.00473551449789763948 	-0.0031015010128094731 	0.00679600317669165534 	0.000498927731410179305 	0.00534312277919853432 	0.00347021641974513614 	0.00337220069515059215 	-0.00622143586125560415 	-0.00127655934433769662 	0.00436484410802257493 	0.00725999145664699315 	-0.00881265446020709428 	-0.00919797829396393901 	0.00462042560691856407 	-0.00919982500002390277 	-0.00889966122589246761 	-0.000627033368822296744 	-0.00140435990570596876 	0.00348752003687192004 	-0.00440996403305462647 	0.00445091226375020094 	0.0015319941118297879 	0.00824276166398773061 	-0.00589422826971325569 	0.00185054823285728774 	0.00735205392812524408 	-0.00932065008082455515 	-0.000164838547741596135 	-0.00854643924540077551 	-0.00311837434025635969 	0.00638201655108370895 	0.00754628751573688337 	-0.00801299059807394562 	0.00976747753260353083 	0.00557945832622598354 	0.00675698139843258425 	-0.00560185246073486697 	-0.00964174761582759464 	-7.80623115802627968e-05 	0.008710366!
 82392008384 	-0.00725561868064580808 	0.00559531193002933518 	!
 -0.00346
921625696461778 	0.00740028832034525172 	-0.00169509809182802015 	0.00873888335497757969 	0.00140994409075873408 	0.000764624405132731822 	0.00994480655086805825 	0.00577877274202991901 	4.74923655357142787e-05 	0.00113531960691515082 	0.00198775187931363737 	-0.00960880431385865812 	0.00658056776284521652 	-0.00755775334700503447 	0.00570729827446314186 	-0.00240907164842276648 	0.00409745863965042811 	
+-0.0101580843643666735 	0.00220138685265899988 	0.00692342144895578479 	0.00135253779638701537 	0.00758775338859351851 	-0.00865001298121899007 	0.00640432763468906825 	0.0073460586540288822 	0.00283515709363264812 	-0.0068139694357583977 	0.0082013411590092164 	0.00112607669227921393 	0.00574348711096823051 	-0.0019457453138970579 	0.00329305905762568817 	0.00804650884764271379 	0.00239784445053587 	0.00133416850160433375 	0.00696031416500525121 	-0.00361325852754340766 	0.00317535270330150622 	0.00103041205817527566 	-0.00107245742990319201 	0.00824480614344477725 	-0.00809761517277060063 	-0.00879378992409048099 	-0.001666700745558108 	-0.00611935317774526567 	0.00666747922470935835 	0.0043264904697058338 	-0.00400025833426162318 	-0.00463514088619843001 	-0.00790622645554470496 	0.0094407604217145117 	-0.00757762707639256846 	-0.00123984285446245295 	-0.00897459440508197558 	0.000655808806812931914 	0.00231099853159869245 	-0.00825376021216044954 	-0.0017404815538026854!
 5 	0.00564452860462577415 	0.00216398564598699284 	0.00972317260517676155 	0.0005894678762475515 	-0.00478986565376872571 	-0.00236489833631728895 	0.00300955478073557494 	0.00195524074096567555 	-0.00824217502136400347 	0.000893913377985541715 	0.00245114206440323265 	-0.00658616856263531496 	0.00207207872110719196 	-0.0059082778485762379 	0.00112430177257065445 	0.00526390526226897665 	0.00672078045843925789 	0.00946230513202510858 	-0.0094489559537055054 	0.00809963710105650672 	0.00668437931449794315 	0.00840677515883614737 	0.00155183361481183758 	0.00554616377539399793 	0.00369188595568001798 	0.00893215807626812457 	0.003872407659562599 	-0.000373571987340624682 	-0.000527998815233036035 	-0.00956064192855578254 	0.00032968408208451953 	0.00668352527862810675 	0.00965851149565612362 	0.00987050937326928828 	-0.00997917409533064133 	-0.00523683447063628092 	-0.00363046515829083816 	-0.000876817464300998911 	-0.000631879126818990543 	-0.000721424646885172405 	-0.002895!
 69358676195973 	-0.00880904917847242369 	-0.002912132184390313!
 35 	0.00
754820876362416199 	-0.00574797924889403674 	-0.00355974802588750888 	0.00773960097716254111 	0.000825076402684549659 	-0.00337517142319696678 	0.00729551532351534193 	-0.00575095374993644676 	0.00784142735362793226 	-0.000854038366632214494 	0.00559184029737643234 	0.00466771002147996564 	-0.00891365004316409248 	0.00999552474884863457 	0.00559196870394438553 	-0.00440332167642452574 	
 ]
 ;
-bias = 2 [ 0.000412185976094302416 -0.000412185976094243869 ] ;
+bias = 2 [ -0.00274640092009917911 0.00274640092009921337 ] ;
 input_size = 100 ;
 output_size = 2 ;
 name = &quot;GradNNetLayerModule&quot; ;
@@ -194,7 +194,6 @@
  )
 *10 -&gt;SoftmaxModule(
 input_size = 2 ;
-output_size = 2 ;
 name = &quot;SoftmaxModule&quot; ;
 estimate_simpler_diag_hessian = 0 ;
 expdir = &quot;&quot; ;

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/global_stats.pmat
===================================================================
(Binary files differ)

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-0/split_stats.pmat
===================================================================
(Binary files differ)

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/Split0/final_learner.psave
===================================================================
--- trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/Split0/final_learner.psave	2007-05-30 15:46:36 UTC (rev 7428)
+++ trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/Split0/final_learner.psave	2007-05-30 15:59:19 UTC (rev 7429)
@@ -15,7 +15,7 @@
 ;
 gibbs_ma_increment = 0.100000000000000006 ;
 gibbs_initial_ma_coefficient = 0.100000000000000006 ;
-bias = 2 [ -0.00333333333333332921 0.0133333333333333359 ] ;
+bias = 2 [ 0.259999999999999731 0.320000000000000118 ] ;
 input_size = 2 ;
 output_size = 2 ;
 name = &quot;RBMBinomialLayer&quot; ;
@@ -25,7 +25,7 @@
 seed = 1827 ;
 fixed_seed = 0  )
  )
-*4 -&gt;RBMBinomialLayer(
+*4 -&gt;RBMMultinomialLayer(
 size = 100 ;
 learning_rate = 0.0100000000000000002 ;
 momentum = 0 ;
@@ -33,116 +33,116 @@
 ;
 gibbs_ma_increment = 0.100000000000000006 ;
 gibbs_initial_ma_coefficient = 0.100000000000000006 ;
-bias = 100 [ -1.00137410413697103 -1.02690878942026043 0.0013724458264565999 0.00132365321189252517 0.00109034043273390229 0.00146910810644214308 0.00146564493916796963 0.00135559708437866275 0.00153281204144994541 0.00123832242421429892 0.00121695024900761667 0.0011245725868343384 0.000930220011041140923 0.000974577325118432952 0.00139635530669787473 0.00144068989267370925 0.00138430041625189014 0.00109169362428812762 0.00128810859720967412 0.00101824372762625054 0.00144881295238288681 0.00113327719680468759 0.00116012910924958267 0.00148977673536533086 0.00104591698509104826 0.00099339501267126009 0.00105134792766416532 0.000944368691288204097 0.00145205653620868462 0.00129923303156562393 0.00154650471141034597 0.00147089797118161525 0.00110567739449515812 0.00140859238954600934 0.00096160211061681951 0.000879602646732325407 0.00103873565996754963 0.00145601682369770344 0.00141907614499988256 0.00111525131849812245 0.00155788072941192082 0.00106909847817215757 0.001479404!
 97705206287 0.00083566921232366303 0.00151725676807298177 0.000926327341824926664 0.00115542254274002493 0.000932488547509163421 0.000986409416525201423 0.00105509493091354711 0.00114020511215720305 0.000949450147756172218 0.00108183255154729505 0.00111153256269310536 0.00159562893939796412 0.00143953006504934531 0.00158599279051363398 0.000987772026471022899 0.00141527662662571251 0.00147970670061907958 0.00114481168316176384 0.000973734604835906374 0.00116015580048555366 0.00145121656285818776 0.00133663825836906488 0.000881629307434726424 0.00154521012374642195 0.00114969705220528554 0.00128179801190255794 0.00102102033233985386 0.00159177766214155291 0.0010635666003404199 0.00115213801918118575 0.00137577640763635912 0.00141704954587943159 0.00148362762732251008 0.00116340609593449458 0.00131550443361816839 0.00162624036901531845 0.00121815130212066421 0.00116713710777807461 0.0012365978120010097 0.000987778170162678356 0.0014446170199076101 0.00119328463684120452 0.001!
 55083767350401407 0.00145157222119383271 0.0010719301623359001!
 7 0.0013
0191044593833192 0.00116763195418857399 0.00117784865577586157 0.00134631952612521361 0.000939096943168237245 0.00115390063459411859 0.000879834511824532971 0.00145512931298407604 0.000980299730962138488 0.000979446353150860904 0.00147952470277208236 0.00153062907310619551 ] ;
+bias = 100 [ -4.88348781864529524 -4.88377909666199628 0.0998136183975280034 0.105471817501073581 0.0944416603126441712 0.0997535283630023306 0.0995807079469193529 0.0969420280226542391 0.101407798986863071 0.103819719061399696 0.0969561262386221256 0.103379686484071684 0.0932604806258945929 0.0949581076326168616 0.0978612202826870531 0.101940630727569329 0.103281189924958716 0.0941595431112412368 0.0998305935628365643 0.0933123105594512864 0.103865433445130051 0.101629187737637211 0.0973778633969569346 0.100349460306733224 0.101767253426589127 0.0939952628691959613 0.0957642872874144568 0.0935745523905245069 0.102064003256194025 0.098361691863909001 0.0989175053269632093 0.10614746415871347 0.0961217644556267847 0.106849253706285979 0.0945216452223907599 0.0952991047808851438 0.100547639463152691 0.0985605833598848236 0.105983428725311607 0.0994327692125842183 0.103893097444509377 0.0968643024791368407 0.102520198423240214 0.100204431378448755 0.103958775859172015 0.093929!
 0211077105641 0.0999474375184054992 0.0929393923414386508 0.0991701323486275238 0.0944082201173512409 0.0945697106806672877 0.092979164059244182 0.093847082093861306 0.0957359700320323803 0.101626912170330402 0.101052854003951226 0.108921157875693647 0.0963814492151018748 0.103458632943262963 0.10290812806515362 0.100178659212683596 0.0971214500704266626 0.0965871618141980054 0.103073960705580364 0.105996494971855496 0.100087602274505388 0.104366272501995302 0.0984793481047083058 0.0999092875429416216 0.093252358955243822 0.104637234166777962 0.102122172258910154 0.10185947931508095 0.101878379680090225 0.100853886423779154 0.10505724942419796 0.0967631186351052552 0.0975018372905746139 0.101409956557437175 0.103055880161497665 0.0989832218691384935 0.0979591861849546941 0.100737252815511005 0.106483496226710883 0.0965834007256001076 0.108223002610933108 0.100965208043670845 0.0988008819013017625 0.100127932147128867 0.103179296286824859 0.100801354336986601 0.1004078925789!
 24268 0.0952068316396505465 0.0982331855345690008 0.0970389632!
 59577809
6 0.100125690380371446 0.094411978606329508 0.0997856098841084227 0.100261110879061907 0.104142637036895802 ] ;
 input_size = 100 ;
 output_size = 100 ;
-name = &quot;RBMBinomialLayer&quot; ;
+name = &quot;RBMMultinomialLayer&quot; ;
 estimate_simpler_diag_hessian = 0 ;
 expdir = &quot;&quot; ;
 random_gen = *3   )
 ] ;
 connections = 1 [ *5 -&gt;RBMMatrixConnection(
 weights = 100  2  [ 
--0.465898380823878189 	-0.5257472271757333 	
--0.415405536827058774 	-0.43237156270415017 	
-0.0377511944185540613 	-0.0222622113836586887 	
--0.0868755264578250919 	-0.0216992332506284885 	
-0.0865009934275749182 	0.0569869095104786963 	
-0.0630219316007317315 	-0.0450340254667259202 	
-0.0666281966527277891 	-0.0446432361850761239 	
-0.0961961981148215656 	-0.0123482149280900386 	
-0.0448151017996752804 	-0.0642693878315704209 	
--0.075006345497866847 	0.00184064232416001391 	
-0.0612971409888469487 	0.0208950902240054789 	
--0.0919222330438322216 	0.0293985588267555581 	
-0.0736577677620802174 	0.0994731168989075043 	
-0.0471323851115119374 	0.0835883750403254439 	
-0.086465269770948025 	-0.0244708540938262734 	
-0.0103599969444587471 	-0.0428593623565605847 	
--0.0304050479262150224 	-0.0318783654306413478 	
-0.0935576694502477518 	0.0570724402824804092 	
-0.0166478901318044374 	-0.00192082664064034334 	
-0.096256754920001325 	0.0757236542388587258 	
--0.0264540261631267398 	-0.0484027660631978635 	
--0.0564610545072463665 	0.0315320791044084101 	
-0.0378904193824292287 	0.0339310050528438475 	
-0.0563158506658397173 	-0.0519713548261833691 	
--0.080606033371540084 	0.0540049341784283113 	
-0.0751040032630000132 	0.0796137877649104458 	
-0.0473667098155404268 	0.0633956816146060143 	
-0.0743799931969063438 	0.0910889996122211248 	
-0.0107056918395281048 	-0.045906624477842238 	
-0.0506652190818280695 	-0.00159507751323828269 	
-0.099295723632253724 	-0.060124582236653755 	
--0.0635127446998727391 	-0.0597685466862121623 	
-0.0533257124070978875 	0.0488376595600343993 	
--0.0937274038724440484 	-0.0437576437563768905 	
-0.0556820696590725611 	0.0860148757514303669 	
-0.0180750237176321576 	0.105163216997359157 	
--0.0565751822925452189 	0.0566121995624142421 	
-0.0849372015611735559 	-0.0388108497910118685 	
--0.0736961337766516011 	-0.0460566342434277493 	
--0.0162489001250914443 	0.0405407415988060307 	
-0.000157946818281875373 	-0.0749297608648691049 	
-0.0272906128648208839 	0.0568927335771478443 	
-0.00815601129881845383 	-0.0533114719315210678 	
--0.0939201689989332816 	0.105273361811564145 	
--0.0111473559009087862 	-0.0653831178259362961 	
-0.0610948303860326739 	0.0954913676837410158 	
--0.0174220266096739157 	0.0297442387380705865 	
-0.0840702104638651332 	0.0973775312699722423 	
--0.0397289685965072012 	0.0711711024413102383 	
-0.0802933310470585054 	0.0641000839691762136 	
-0.0968309977815658418 	0.0438330542369773438 	
-0.0880958768773097006 	0.0923753972929968747 	
-0.0985443015806782563 	0.0599778624457802736 	
-0.0619249323315275157 	0.0494478047310362989 	
-0.0545448318081365249 	-0.0780754060476148287 	
-0.0285113858607967639 	-0.0409584131047952341 	
--0.089918399505542923 	-0.090022109061663344 	
-0.018918952502982922 	0.0772576604645199699 	
--0.0265314066894932928 	-0.0395818057802785617 	
-0.000473440135177595998 	-0.0541903410229482366 	
--0.0243895218138544187 	0.0314580617326275375 	
--8.81216288233764317e-05 	0.0789141109871618063 	
-0.0552237333575481895 	0.035584648552184947 	
--0.00976359847531528026 	-0.0477894835382122185 	
--0.093841357470886122 	-0.0256801896714868479 	
--0.0819052561031868576 	0.0948115209067496439 	
--0.0122660894056416878 	-0.0729104201736537477 	
-0.0118347938134664987 	0.0340559807103727602 	
-0.0134708848282789617 	-0.000572578382826163801 	
-0.0964559269836439137 	0.0769043990377378389 	
--0.00583661421481141383 	-0.0847893619270053411 	
--0.0826000181463166228 	0.0479596982245045905 	
--0.056757225176007467 	0.026610005930452138 	
--0.00441156243096314099 	-0.0270501719769326299 	
-0.0268252609052835496 	-0.0348865253720667887 	
--0.0395922519937956865 	-0.0607140283455538318 	
-0.0530709135422441428 	0.0336849212342133636 	
-0.0735224643489766627 	-0.00379001431917099733 	
-0.0694480810439801199 	-0.087284121902583528 	
--0.064947302954847394 	0.00827124620280034542 	
-0.00554519691252461974 	0.0287814138263757166 	
-0.0439607797669580233 	0.0142535323411294712 	
--0.073442074952868322 	0.070269798400858674 	
--0.0767863076968120367 	-0.0534094187858660877 	
-0.0637298453652152125 	0.0273605378954342518 	
--0.0822979792355355844 	-0.0836431836016150454 	
-0.0326964528683156563 	-0.042956796320541904 	
--0.0129164191936799039 	0.0518554462175771017 	
-0.0137682750812957444 	-0.00583597402461049405 	
--0.0794433970526516736 	0.0207009222471596296 	
--0.0295528976169957165 	0.0225166325312974626 	
-0.0187111028799756968 	-0.016994615303334501 	
-0.0332811139570624998 	0.0915651040128478422 	
-0.0183022051395993236 	0.0334379478508383537 	
--0.0190011281073977981 	0.100777493760880507 	
-0.0515010175441200577 	-0.0423897860144714991 	
-0.0615408062541729015 	0.0827164365885962177 	
--0.0540417000828431193 	0.0718081644326928614 	
-0.0553872624377869452 	-0.0491302545426191839 	
--0.0112378581648205737 	-0.0691817878400538266 	
+-0.595479171538772722 	-0.64784326563401029 	
+-0.6152383374774405 	-0.62664605667428297 	
+0.0538900294397439625 	-0.0137742833948165666 	
+-0.06875053142052448 	-0.0128356405145059246 	
+0.101750482831042335 	0.0645179709928756923 	
+0.0788404196343822777 	-0.0363313352895024214 	
+0.0823984677889268713 	-0.0359772385695514424 	
+0.111455643794722073 	-0.0041048261939523184 	
+0.0609652140478198282 	-0.0553056639846301532 	
+-0.0571686153486568316 	0.0104202988290012701 	
+0.0769767542086592094 	0.0288702909576745818 	
+-0.0738826113496724585 	0.0376651648655449978 	
+0.0890025291790312034 	0.10658630388745495 	
+0.0628827179229135558 	0.0909309318538381317 	
+0.10189692292911387 	-0.0160894138207842603 	
+0.0269756763337721632 	-0.0340491698234521578 	
+-0.0131781351491743748 	-0.0230764112596843103 	
+0.108709363233458617 	0.0645946658963587189 	
+0.0330446970922479225 	0.00641644683858688409 	
+0.111338474011847738 	0.0830744128480884469 	
+-0.00923663549878874814 	-0.039419952693748761 	
+-0.0390168467135288966 	0.0396927629301102661 	
+0.053884855284114519 	0.04179601820019576 	
+0.0722589195882538532 	-0.0431916351119050954 	
+-0.0628580553109818196 	0.0620282656863879525 	
+0.0904696456760091527 	0.0869795013810659712 	
+0.063155692471325367 	0.0709411651936545651 	
+0.089737672806708732 	0.0983663784623535764 	
+0.0273272832467084566 	-0.0370754352212264021 	
+0.0665515477695941549 	0.0066554552858713676 	
+0.114615148493610874 	-0.0513201825260645936 	
+-0.0456422913795766633 	-0.0504568195824679211 	
+0.0690561056867186052 	0.0565546631705502456 	
+-0.0754060455133410135 	-0.0346219815131878009 	
+0.0713063685070573078 	0.0933620354169992783 	
+0.0341980957421883225 	0.112370604562321522 	
+-0.0392048865688329473 	0.0645005741897170942 	
+0.100413128501990342 	-0.0302192489756252305 	
+-0.0557068816320919549 	-0.0369117849033234677 	
+0.000529733929197445555 	0.0485162644411036431 	
+0.0170355689113608696 	-0.0656936836103067801 	
+0.0433878525009998087 	0.0645360645558576557 	
+0.0248375275797735988 	-0.0443637944730375239 	
+-0.0760831140867710143 	0.112732191490474212 	
+0.00587915934077326303 	-0.0562115972021530463 	
+0.0766272396820571744 	0.102736863234715051 	
+-0.000592684940426663198 	0.0378303322767531494 	
+0.0992806567766493231 	0.104535562881183208 	
+-0.0226534723321051186 	0.078833337275821494 	
+0.0956148861294622843 	0.0716084093953505973 	
+0.111961983119019282 	0.051503114001920508 	
+0.103261697334856059 	0.0995893663062659279 	
+0.113622132076437066 	0.0674654151128029206 	
+0.077537126133991538 	0.0570887588626447992 	
+0.0705810984356155524 	-0.0689366435996839194 	
+0.044843023134881678 	-0.0322309100088603792 	
+-0.0714869712521966627 	-0.0802860339949844209 	
+0.0350917134068162717 	0.0847180859020596616 	
+-0.00934136513864572242 	-0.0307058733146445689 	
+0.017274684402242526 	-0.0451641166704254277 	
+-0.00744338758825806822 	0.0394987995010958187 	
+0.01635978807368689 	0.0864131668208693443 	
+0.070961277310940693 	0.043396773338633815 	
+0.00718060967436378282 	-0.0388226740324390598 	
+-0.0755833033596572668 	-0.0167504198245917932 	
+-0.0642340161003093629 	0.102350333481158032 	
+0.00480424872243435854 	-0.0636443844298318767 	
+0.0282189683208145629 	0.0419719166047329909 	
+0.0299132095892969477 	0.0077544045179868985 	
+0.111530306999090334 	0.0842099709862055845 	
+0.0111726585535115806 	-0.0753750532311086713 	
+-0.0647904300854395543 	0.0560328728134857762 	
+-0.0392948976134837868 	0.0348323569795132501 	
+0.012391516944369076 	-0.0184093328026520009 	
+0.0431605911084246147 	-0.0262028154072604068 	
+-0.0221174993040646715 	-0.0514567367068857959 	
+0.0688357274057207064 	0.0415705062017272323 	
+0.089084785497041255 	0.00441555037709988676 	
+0.0852942013840160274 	-0.0781125130895272968 	
+-0.0472940655022145579 	0.0167306727323274437 	
+0.0220238553939347825 	0.0368257958383149744 	
+0.0599111578444758708 	0.0223267883631605574 	
+-0.0558570133839886712 	0.0780883336256121968 	
+-0.058716698004954028 	-0.0441544608089798341 	
+0.0793606765007453807 	0.0352579600100396198 	
+-0.0640094082428914329 	-0.0739527557808974945 	
+0.0489600429692438679 	-0.0341678748008232419 	
+0.00379375700322669715 	0.0596590822724617914 	
+0.0302207297680062159 	0.00254921219936410934 	
+-0.0616037449568939341 	0.0290990160924210692 	
+-0.0125089212557680796 	0.0306990708174415296 	
+0.0351162640727813863 	-0.00848184184674327137 	
+0.0492138445592737589 	0.0988530120564841547 	
+0.0345815650076597633 	0.0413837339984958752 	
+-0.00231189629031252003 	0.1080671288555725 	
+0.0674832518044770763 	-0.0336835252022576678 	
+0.0770889815106832327 	0.0900588562201595916 	
+-0.0367474445651055151 	0.0795105696210816892 	
+0.0713351233590624745 	-0.0403765780191503165 	
+0.00580328195072377442 	-0.0599406438638086306 	
 ]
 ;
 gibbs_ma_schedule = []
@@ -178,11 +178,11 @@
 L1_penalty_factor = 0 ;
 L2_penalty_factor = 0 ;
 weights = 2  100  [ 
-0.017008554997057692 	0.0104387876115214877 	-0.00136459452131401692 	-0.007694830893472452 	0.0024444011559232909 	-0.0078228201312652481 	-0.00358938045145438395 	0.00412097543907406164 	-0.00506516401766118809 	-0.00250251244769061909 	0.00964740260385949823 	-0.00966548314037402566 	-0.00720963742471932793 	-0.00735244692905994649 	-0.00819882043413208174 	0.00105377283442701676 	-0.00559300587724305149 	-0.00201317355851039163 	0.00889510240232954837 	-0.00172946756473074843 	-0.00770847256928006239 	0.000109134497070920112 	-0.00965413118259607871 	-0.00183440390754073036 	0.00712978011451060895 	-0.00175611232543246309 	-0.00687969094841575819 	0.0075740713823546869 	-0.00656146052637328163 	0.00845127777823999511 	0.00815461804420629204 	0.00293687577159292348 	-2.79965314463935869e-05 	-0.00733751516448193173 	0.00268709723932520793 	0.00039533036134122262 	-0.00736099423109966029 	0.00958590200963892192 	0.000630166324511920737 	0.00222194466177643834 	-0.00843006!
 948794802931 	-0.00472781073398588839 	-0.00279420740702469254 	0.0066165067854904204 	0.000837489333667666594 	0.00521865545287852634 	0.00353842611234711111 	0.00322515828079153986 	-0.00627397155868205606 	-0.00129925620463139705 	0.0044105156653273048 	0.00712836246720142692 	-0.00882568553700607307 	-0.0091660636923518099 	0.00500033619746034601 	-0.00891941496497438389 	-0.00843611819587269419 	-0.000679800346760737139 	-0.00114007892583917192 	0.00379367606564552044 	-0.004347221497421218 	0.00439103874927778554 	0.00160623852285541138 	0.00853054253947964705 	-0.00568070806358677086 	0.00170762630165911204 	0.00771245518597830134 	-0.00925088914422879556 	-1.26860580047685571e-07 	-0.00862228977062608898 	-0.0027262074447650499 	0.00636127260976974973 	0.00760435532899364757 	-0.00777906044286228414 	0.0100299539966816724 	0.005904837604418239 	0.00683424730708538306 	-0.00540610720721784906 	-0.0092320567611166738 	2.99290581919610605e-05 	0.00878979679866237484 	-!
 0.00712125981352962605 	0.00551979760016440592 	-0.00315813358!
 73988284
 	0.0075000535504068204 	-0.00126699128886875278 	0.00902304204833798661 	0.00142102496993732545 	0.000943934729021668234 	0.0100057447306505978 	0.00586249806435862504 	0.000258289821636560309 	0.00103786744919908249 	0.00205915322665153454 	-0.00972949605808085503 	0.00687177560776495132 	-0.00763727375797339063 	0.00564417353588726051 	-0.00209763415342224639 	0.00444577511520436851 	
--0.0158403468049550245 	-0.00182247473424640232 	0.00668954215975122411 	0.00115277383376725853 	0.00758554581483015383 	-0.00895334785192393109 	0.00609888586492709009 	0.00711600319984317074 	0.00248981458245101876 	-0.00693702454197584872 	0.00808262093110903405 	0.0010966183217116475 	0.00588804278876337277 	-0.00186942145091290664 	0.00303148973509062428 	0.00776670206774096768 	0.00215723462148917485 	0.0013345561537366009 	0.00679093630691612101 	-0.00354080599033937231 	0.00288491424340078361 	0.000985987220009603219 	-0.00114888180500262276 	0.00792545344460340341 	-0.00806023738335212049 	-0.00871808178586999834 	-0.0016545013408099463 	-0.00600167274120792186 	0.00637856793933743935 	0.00414600630594605564 	-0.00436092589312168499 	-0.00496395924859824485 	-0.00793760870886877669 	0.00915926255410397239 	-0.00748824086600762256 	-0.00110404870777303858 	-0.00894926412761726589 	0.00035852850087464091 	0.0020266565133773215 	-0.00829223165657636853 	-0.00210625789!
 739553575 	0.00563682484071408377 	0.00185669204020226216 	0.0099026689963780546 	0.000250906273990107688 	-0.00466539832744864227 	-0.00243310802891919843 	0.00315659719509466669 	0.00200777643839219729 	-0.00821947816107023409 	0.000848241820680825827 	0.00258277105384882143 	-0.00657313748583628066 	0.00204016411949509927 	-0.00628818843911795825 	0.000843891737521266215 	0.00480036223224925441 	0.00677354743637774859 	0.00919802415215835271 	-0.00975511198247906199 	0.00803689456542313815 	0.0067442528289704002 	0.00833253074781055945 	0.00126405273931993805 	0.00533264356926755733 	0.00383480788687822708 	0.0085717568184150994 	0.00380264672296687844 	-0.000538283674502128382 	-0.000452148290007688852 	-0.00995280882404701861 	0.000350428023398520385 	0.00662545746537139633 	0.00942458134044455928 	0.00960803290919119181 	-0.0103045533735228664 	-0.0053141003792890433 	-0.00382621041180779666 	-0.00128650831901190262 	-0.000739870496591170097 	-0.00080085462162742579 	!
 -0.00303005245387808105 	-0.0087335348486074077 	-0.0032232148!
 53956046
35 	0.00744844353356260459 	-0.00617608605185327765 	-0.00384390671924787547 	0.007728520097984002 	0.000645766078795653037 	-0.00343610960297948201 	0.00721179000118664891 	-0.00596175120603724407 	0.0079388795113440689 	-0.000925439713970062014 	0.00571253204159864313 	0.00437650217656029242 	-0.00883412963219572939 	0.0100586494874245549 	0.00528053120894389754 	-0.00475163815197840889 	
+0.0123420928014191557 	0.00916499543260136142 	-0.00164506058869937706 	-0.00792958713804811817 	0.00236549116291899161 	-0.00816839208649198199 	-0.00393729201208150355 	0.00383571983020708843 	-0.00544728800267464154 	-0.00266053897009083237 	0.00946810364372980065 	-0.00972470140984709429 	-0.00715049251794375867 	-0.00734869875953185047 	-0.00851045478860876919 	0.000733198497111745766 	-0.00587341695528064214 	-0.00209131432022617624 	0.00867743624742249239 	-0.0017424290544537477 	-0.00803777150919455716 	2.68947234888736322e-05 	-0.00978963001083593166 	-0.00219383685419234338 	0.00713629807466046543 	-0.00176071907009400916 	-0.00693551341442328901 	0.00760840838401072046 	-0.00689064362225262801 	0.00821779551345410038 	0.00775615975335418317 	0.00256994077777214979 	-0.000125487652430558499 	-0.00765557075172304709 	0.00270057028444748272 	0.00046445864750938883 	-0.00737340071900496018 	0.00924350722960627647 	0.000308359129016674426 	0.00213576384551587362 	-0.0!
 088316481921647573 	-0.00479667378996827178 	-0.00314050304959243281 	0.00677359813450965909 	0.000461574357387472775 	0.0052630551506867209 	0.00342377191963190138 	0.00328382212079000564 	-0.00626455935271803908 	-0.0013538271142407624 	0.00428995531271315206 	0.00717178746011403519 	-0.0088934328165411157 	-0.00926633853826809052 	0.00458758045120281812 	-0.00924171707330578331 	-0.00894077273613546816 	-0.000689382609061560837 	-0.00144386531203365576 	0.00344874682264902479 	-0.00445501595657440182 	0.004394399096584377 	0.00146877925949968121 	0.00820337445445518988 	-0.00592893418508044692 	0.00182255472740502585 	0.00731552216505707183 	-0.0093740454197580262 	-0.000212912355459384688 	-0.00863228712512623987 	-0.00315315105065477495 	0.00635133933025240714 	0.00750852663533482529 	-0.00805517934762344651 	0.00972441442848316455 	0.00554144065331621354 	0.0066946947510606019 	-0.00565723229911999602 	-0.00967100372334113619 	-0.00011446669224282846 	0.00865912090766!
 649163 	-0.00731143980482081186 	0.005563065733680898 	-0.0035!
 07002722
15526175 	0.00733748393075391286 	-0.00173505410219775436 	0.0086972297748011216 	0.00136029609347290388 	0.000717391705312010676 	0.00991167438484492555 	0.00573543123204991317 	1.6357813687929368e-06 	0.0010656448048303839 	0.00193302874506671692 	-0.00966095349810980504 	0.00653802734483208657 	-0.00763470234441813913 	0.00566876259818077221 	-0.00244991794631276147 	0.00406053318954284741 	
+-0.011173884609316509 	-0.000548682555326316496 	0.00697000822713652116 	0.00138753007834285054 	0.00766445580783437982 	-0.00860777589669724404 	0.00644679742555415245 	0.00740125880871012228 	0.002871938567464418 	-0.00677899801957569919 	0.0082619198912386952 	0.00115583659118469271 	0.00582889788198777143 	-0.00187316962044102499 	0.00334312408956729222 	0.00808727640505616137 	0.00243764569952671997 	0.00141269691545234518 	0.00700860246182310586 	-0.00352784450061643289 	0.00321421318331525842 	0.00106822699359159987 	-0.0010133829767628522 	0.00828488639125499193 	-0.00806675534350202728 	-0.00871347504120848111 	-0.00159867887480246037 	-0.00603600974286399965 	0.00670775103521673542 	0.00437948857073182807 	-0.00396246760226966373 	-0.00459702425477752624 	-0.00784011758788464436 	0.00947731814134509035 	-0.00750171391112993986 	-0.00117317699394124133 	-0.00893685763971203972 	0.000700923280907215672 	0.0023484637088725213 	-0.00820605084031584588 	-0.001704679193!
 17889645 	0.00570568789669640732 	0.00220298768276995212 	0.00974557764735873959 	0.000626821250270258572 	-0.00470979802525691143 	-0.00231845383620405418 	0.00309793335509616231 	0.00199836423242812436 	-0.00816490725146091709 	0.000968802173294958623 	0.00253934606093618453 	-0.006505390206301284 	0.00214043896541134737 	-0.00587543269286049195 	0.00116619384585259201 	0.0053050167725119373 	0.00678312969867851581 	0.00950181053835282355 	-0.00941018273948261187 	0.00814468902457630116 	0.0067408924816637671 	0.00846999001116627986 	0.0015912208243443885 	0.00558086969076118568 	0.00371987946113228442 	0.00896868983933632111 	0.00392580299849605227 	-0.000325498179622836156 	-0.000442150935507603716 	-0.00952586521815736338 	0.000360361302915814029 	0.0067212861590301657 	0.0097007002452056193 	0.00991357247738965976 	-0.00994115642242088086 	-0.00517454782326429597 	-0.00357508531990572255 	-0.000847561356787462027 	-0.000595474746156425408 	-0.000670178730631581176 	-0!
 .00283987246258697937 	-0.00877680298212393101 	-0.00287434571!
 91996672
1 	0.00761101315321550433 	-0.00570802323852433353 	-0.00351809444571104602 	0.00778924897444837824 	0.000872309102505269395 	-0.00334203925717386965 	0.00733885683349534603 	-0.00570509716576950762 	0.00791110215571273409 	-0.000799315232385289817 	0.00564398948162753416 	0.00471025043949309646 	-0.00883670104575096267 	0.0100340604251309921 	0.00563281500183433932 	-0.0043663962263169433 	
 ]
 ;
-bias = 2 [ 7.01176701747223234e-05 -7.01176701746282147e-05 ] ;
+bias = 2 [ -0.00391578848611695649 0.00391578848611705884 ] ;
 input_size = 100 ;
 output_size = 2 ;
 name = &quot;GradNNetLayerModule&quot; ;
@@ -194,7 +194,6 @@
  )
 *10 -&gt;SoftmaxModule(
 input_size = 2 ;
-output_size = 2 ;
 name = &quot;SoftmaxModule&quot; ;
 estimate_simpler_diag_hessian = 0 ;
 expdir = &quot;&quot; ;

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/global_stats.pmat
===================================================================
(Binary files differ)

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/.pytest/PL_DBN_Mini-batch/expected_results/expdir-dbn-3-1/split_stats.pmat
===================================================================
(Binary files differ)

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/PL_DBN_Mini-batch.pyplearn
===================================================================
--- trunk/plearn_learners/online/test/DeepBeliefNet/PL_DBN_Mini-batch.pyplearn	2007-05-30 15:46:36 UTC (rev 7428)
+++ trunk/plearn_learners/online/test/DeepBeliefNet/PL_DBN_Mini-batch.pyplearn	2007-05-30 15:59:19 UTC (rev 7429)
@@ -31,90 +31,90 @@
 
 for batch_size in [ 1, 3 ]:
     for online in [ 0, 1 ]:
-        dbn = pl.DeepBeliefNet( 
+        dbn = pl.DeepBeliefNet(
             cd_learning_rate = cd_lr,
             batch_size = batch_size,
             connections = [
-                pl.RBMMatrixConnection( 
+                pl.RBMMatrixConnection(
                     down_size = input_size,
                     learning_rate = conn_lr,
                     up_size = n_units,
                     random_gen = pl.PRandom( seed = 1827 )
                 )
             ],
-        
+
             final_cost =
-                pl.CombiningCostsModule( 
+                pl.CombiningCostsModule(
                     cost_weights = [ 1, 0 ],
                     sub_costs = [
-                        pl.NLLCostModule( 
+                        pl.NLLCostModule(
                             input_size = n_classes,
                             output_size = 1,
                             target_size = 1
                         ),
-        
-                        pl.ClassErrorCostModule( 
+
+                        pl.ClassErrorCostModule(
                             input_size = 2,
                             output_size = 1,
                             target_size = 1
                         )
-        
+
                     ]
                 ),
-        
-        
-            final_module = 
-                pl.ModuleStackModule( 
+
+
+            final_module =
+                pl.ModuleStackModule(
                     estimate_simpler_diag_hessian = 0,
                     modules = [
-                        pl.GradNNetLayerModule( 
+                        pl.GradNNetLayerModule(
                             input_size = n_units,
                             output_size = 2,
                             start_learning_rate = nnet_lr,
                             random_gen = pl.PRandom( seed = 1827 )
                         ),
-        
-                        pl.SoftmaxModule( 
+
+                        pl.SoftmaxModule(
                             input_size = 2
                         )
                     ],
                 ),
-        
+
             grad_learning_rate = grad_lr,
-        
+
             layers = [
-                pl.RBMBinomialLayer( 
+                pl.RBMBinomialLayer(
                     learning_rate = rbm_lr,
                     size = input_size
                 ),
-        
-                pl.RBMBinomialLayer( 
+
+                pl.RBMMultinomialLayer(
                     learning_rate = rbm_lr,
                     size = n_units
                 )
             ],
-        
-        
+
+
             n_classes = 2,
-        
+
             nstages = nstage_tot,
-        
+
             online = online,
-        
+
             partial_costs = [
-                pl.NLLCostModule( 
+                pl.NLLCostModule(
                     input_size = n_units,
                     output_size = 1,
                     target_size = 1
                 )
             ],
-        
+
             reconstruct_layerwise = 0,
-        
+
             training_schedule = [ greedy_1, greedy_all ],
-        
+
             use_classification_cost = use_class_cost
-        
+
         )
         ptesters.append(
                 pl.PTester(
@@ -129,7 +129,7 @@
                     save_stat_collectors = 0,
                     save_test_outputs = 0,
                     splitter =
-                        pl.ExplicitSplitter( 
+                        pl.ExplicitSplitter(
                             splitsets = TMat(1, 2, [ dataset, dataset ])
                         ),
                     statnames = [
@@ -138,7 +138,7 @@
                     ]
                 )
             )
-        
+
 def main():
     return pl.RunObject(
             objects     = ptesters,

Modified: trunk/plearn_learners/online/test/DeepBeliefNet/pytest.config
===================================================================
--- trunk/plearn_learners/online/test/DeepBeliefNet/pytest.config	2007-05-30 15:46:36 UTC (rev 7428)
+++ trunk/plearn_learners/online/test/DeepBeliefNet/pytest.config	2007-05-30 15:59:19 UTC (rev 7429)
@@ -104,7 +104,7 @@
     resources = [ &quot;PL_DBN_Mini-batch.pyplearn&quot; ],
     precision = 1e-06,
     pfileprg = &quot;__program__&quot;,
-    disabled = True
+    disabled = False
     )
 
 Test(


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000877.html">[Plearn-commits] r7428 - trunk/plearn_learners/online
</A></li>
	<LI>Next message: <A HREF="000879.html">[Plearn-commits] r7430 - trunk/plearn/vmat
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#878">[ date ]</a>
              <a href="thread.html#878">[ thread ]</a>
              <a href="subject.html#878">[ subject ]</a>
              <a href="author.html#878">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/plearn-commits">More information about the Plearn-commits
mailing list</a><br>
</body></html>
