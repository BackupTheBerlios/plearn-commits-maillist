<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Plearn-commits] r8324 - trunk/speedtest
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/plearn-commits/2007-November/index.html" >
   <LINK REL="made" HREF="mailto:plearn-commits%40lists.berlios.de?Subject=Re%3A%20%5BPlearn-commits%5D%20r8324%20-%20trunk/speedtest&In-Reply-To=%3C200711291731.lATHV71n026414%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001771.html">
   <LINK REL="Next"  HREF="001773.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Plearn-commits] r8324 - trunk/speedtest</H1>
    <B>nouiz at BerliOS</B> 
    <A HREF="mailto:plearn-commits%40lists.berlios.de?Subject=Re%3A%20%5BPlearn-commits%5D%20r8324%20-%20trunk/speedtest&In-Reply-To=%3C200711291731.lATHV71n026414%40sheep.berlios.de%3E"
       TITLE="[Plearn-commits] r8324 - trunk/speedtest">nouiz at mail.berlios.de
       </A><BR>
    <I>Thu Nov 29 18:31:07 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001771.html">[Plearn-commits] r8323 - trunk/speedtest
</A></li>
        <LI>Next message: <A HREF="001773.html">[Plearn-commits] r8325 - trunk/speedtest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1772">[ date ]</a>
              <a href="thread.html#1772">[ thread ]</a>
              <a href="subject.html#1772">[ subject ]</a>
              <a href="author.html#1772">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: nouiz
Date: 2007-11-29 18:31:06 +0100 (Thu, 29 Nov 2007)
New Revision: 8324

Modified:
   trunk/speedtest/Makefile
   trunk/speedtest/xgemm.c
Log:
corrected the handling of float vs double


Modified: trunk/speedtest/Makefile
===================================================================
--- trunk/speedtest/Makefile	2007-11-29 17:09:40 UTC (rev 8323)
+++ trunk/speedtest/Makefile	2007-11-29 17:31:06 UTC (rev 8324)
@@ -35,55 +35,55 @@
 xgemm-cxgemm: xgemm-sgemm-c xgemm-dgemm-c
 
 xgemm-sgemm-acml: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEFLOAT $&lt; ${LIBACML}
+	${CC} ${CFLAGS} -o $@ -DUSEFLOAT $&lt; ${LIBACML}
 
 xgemm-sgemm-acmlpt: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEFLOAT $&lt; -fopenmp ${LIBACMLPT}
+	${CC} ${CFLAGS} -o $@ -DUSEFLOAT $&lt; -fopenmp ${LIBACMLPT}
 
 xgemm-sgemm-atlas: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEFLOAT $&lt; ${LIBATLAS}
+	${CC} ${CFLAGS} -o $@ -DUSEFLOAT $&lt; ${LIBATLAS}
 
 xgemm-dgemm-atlas: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEDOUBLE $&lt; ${LIBATLAS}
+	${CC} ${CFLAGS} -o $@ -DUSEDOUBLE $&lt; ${LIBATLAS}
 
 xgemm-sgemm-blas: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEFLOAT $&lt; ${LIBBLAS}
+	${CC} ${CFLAGS} -o $@ -DUSEFLOAT $&lt; ${LIBBLAS}
 
 xgemm-dgemm-blas: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEDOUBLE $&lt; ${LIBBLAS}
+	${CC} ${CFLAGS} -o $@ -DUSEDOUBLE $&lt; ${LIBBLAS}
 
 xgemm-sgemm-blas-compare: xgemm.c
 	${CC} ${CFLAGS} -o $@ $&lt; ${LIBBLAS} -DCOMPARE
 
 xgemm-sgemm-c: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEFLOAT $&lt; -DCXGEMM 
+	${CC} ${CFLAGS} -o $@ -DUSEFLOAT $&lt; -DCXGEMM 
 
 xgemm-dgemm-c: xgemm.c
-	${CC} ${CFLAGS} -o $@ $&lt; -DCXGEMM -USEDOUBLE
+	${CC} ${CFLAGS} -o $@ $&lt; -DCXGEMM -DUSEDOUBLE
 
 xgemm-sgemm-goto: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEFLOAT $&lt; ${LIBGOTO}
+	${CC} ${CFLAGS} -o $@ -DUSEFLOAT $&lt; ${LIBGOTO}
 
 xgemm-dgemm-goto: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEDOUBLE $&lt; ${LIBGOTO}
+	${CC} ${CFLAGS} -o $@ -DUSEDOUBLE $&lt; ${LIBGOTO}
 
 xgemm-sgemm-goto-compare: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEFLOAT $&lt; -DCOMPARE ${LIBGOTO}
+	${CC} ${CFLAGS} -o $@ -DUSEFLOAT $&lt; -DCOMPARE ${LIBGOTO}
 
 xgemm-sgemm-mkl: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEDOUBLE $&lt; ${LIBMKL}
+	${CC} ${CFLAGS} -o $@ -DUSEDOUBLE $&lt; ${LIBMKL}
 
 xgemm-dgemm-mkl: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEFLOAT $&lt; ${LIBMKL}
+	${CC} ${CFLAGS} -o $@ -DUSEFLOAT $&lt; ${LIBMKL}
 
 xgemm-sgemm-mklpt: xgemm.c
-	${CC} ${CFLAGS} -o $@ -USEFLOAT $&lt; ${LIBMKLPT}
+	${CC} ${CFLAGS} -o $@ -DUSEFLOAT $&lt; ${LIBMKLPT}
 
 xgemm-sgemm-nvidia: xgemm.c
-	${CC} ${CFLAGS} -m32 -o $@ -USEFLOAT $&lt;  ${LIBNVIDIA} -DNVIDIA
+	${CC} ${CFLAGS} -m32 -o $@ -DUSEFLOAT $&lt;  ${LIBNVIDIA} -DNVIDIA
 
 xgemm-sgemm-nvidia-compare: xgemm.c
-	${CC} ${CFLAGS} -m32 -o $@ -USEFLOAT $&lt; ${LIBNVIDIA} -DNVIDIA -DCOMPARE
+	${CC} ${CFLAGS} -m32 -o $@ -DUSEFLOAT $&lt; ${LIBNVIDIA} -DNVIDIA -DCOMPARE
 
 xgemv: xgemv-blas xgemv-blas-compare xgemv-cxgemm xgemv-goto xgemv-goto-compare xgemv-nvidia xgemv-nvidia-compare xgemv-sgemv-goto xgemv-dgemv-goto xgemv-sgemv-blas xgemv-dgemv-blas
 	true
@@ -116,13 +116,13 @@
 	${CC} ${CFLAGS} -o $@ $&lt; ${LIBGOTO}
 
 xgemv-dgemv-goto: xgemv.c
-	${CC} ${CFLAGS} -o $@ -USEDOUBLE $&lt; ${LIBGOTO}
+	${CC} ${CFLAGS} -o $@ -DUSEDOUBLE $&lt; ${LIBGOTO}
 
 xgemv-sgemv-blas: xgemv.c
 	${CC} ${CFLAGS} -o $@ $&lt; ${LIBBLAS}
 
 xgemv-dgemv-blas: xgemv.c
-	${CC} ${CFLAGS} -o $@ -USEDOUBLE $&lt; ${LIBBLAS}
+	${CC} ${CFLAGS} -o $@ -DUSEDOUBLE $&lt; ${LIBBLAS}
 
 clean: clean-xgemv
 	rm -f xgemm-blas-compare xgemm-goto-compare xgemm-nvidia-compare xgemm-blas xgemm-goto xgemm-nvidia xgemm-cxgemm

Modified: trunk/speedtest/xgemm.c
===================================================================
--- trunk/speedtest/xgemm.c	2007-11-29 17:09:40 UTC (rev 8323)
+++ trunk/speedtest/xgemm.c	2007-11-29 17:31:06 UTC (rev 8324)
@@ -12,12 +12,14 @@
   /* Includes, cblas */
   #include &lt;gsl/gsl_cblas.h&gt;
 #endif
-#ifdef DOUBLE
+#ifdef USEDOUBLE
   typedef double real;
   #define cblas_xgemm cblas_dgemm
-#else
+#elif USEFLOAT
   typedef float real;
   #define cblas_xgemm cblas_sgemm
+#else
+  #error &quot;USEDOUBLE or USEFLOAT must be defined&quot;
 #endif
 //#include &lt;iostream&gt;
 //using namespace std;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001771.html">[Plearn-commits] r8323 - trunk/speedtest
</A></li>
	<LI>Next message: <A HREF="001773.html">[Plearn-commits] r8325 - trunk/speedtest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1772">[ date ]</a>
              <a href="thread.html#1772">[ thread ]</a>
              <a href="subject.html#1772">[ subject ]</a>
              <a href="author.html#1772">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/plearn-commits">More information about the Plearn-commits
mailing list</a><br>
</body></html>
